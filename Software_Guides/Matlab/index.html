
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the centrally provided Research Computing HPC services at UCL.">
      
      
        <meta name="author" content="UCL RCAS Team">
      
      
        <link rel="canonical" href="https://www.rc.ucl.ac.uk/docs/Software_Guides/Matlab/">
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.0">
    
    
      
        <title>MATLAB - UCL Research Computing Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.82f3c0b9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/tweaks.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="UCL Research Computing Documentation" class="md-header__button md-logo" aria-label="UCL Research Computing Documentation" data-md-component="logo">
      
  <img src="../../img/portico.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UCL Research Computing Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MATLAB
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="UCL Research Computing Documentation" class="md-nav__button md-logo" aria-label="UCL Research Computing Documentation" data-md-component="logo">
      
  <img src="../../img/portico.svg" alt="logo">

    </a>
    UCL Research Computing Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Account_Services/" class="md-nav__link">
        Account Services
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Additional_Resource_Requests/" class="md-nav__link">
        Additional Resource Requests
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Contact_Us/" class="md-nav__link">
        Contact and Support
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Example_Jobscripts/" class="md-nav__link">
        Example Jobscripts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Experienced_Users/" class="md-nav__link">
        Quick Start Guide for Experienced HPC Users
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Interactive_Jobs/" class="md-nav__link">
        Interactive Job Sessions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Job_Results/" class="md-nav__link">
        Where do my results go?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../New_Users/" class="md-nav__link">
        Guide for New Users
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Planned_Outages/" class="md-nav__link">
        Planned Outages
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Remote_Access/" class="md-nav__link">
        Remote Access
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Status_page/" class="md-nav__link">
        Status of machines
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Terms_and_Conditions/" class="md-nav__link">
        Terms and Conditions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../UCL_Service_For_Me/" class="md-nav__link">
        UCL Service For Me
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../howto/" class="md-nav__link">
        How To
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_16" type="checkbox" id="__nav_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_16">
          Background
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Background" data-md-level="1">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Background
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Background/Cluster_Computing/" class="md-nav__link">
        Cluster Computing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17" type="checkbox" id="__nav_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_17">
          Clusters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Clusters" data-md-level="1">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          Clusters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Clusters/Myriad/" class="md-nav__link">
        Myriad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Clusters/Grace/" class="md-nav__link">
        Grace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Clusters/Kathleen/" class="md-nav__link">
        Kathleen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Clusters/Thomas/" class="md-nav__link">
        MMM Thomas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Clusters/Michael/" class="md-nav__link">
        MMM Michael
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Clusters/Young/" class="md-nav__link">
        MMM Hub Young
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_18" type="checkbox" id="__nav_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_18">
          Installed Software Lists
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installed Software Lists" data-md-level="1">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          Installed Software Lists
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Installed_Software_Lists/module-packages/" class="md-nav__link">
        General Software Lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Installed_Software_Lists/python-packages/" class="md-nav__link">
        Python Packages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Installed_Software_Lists/r-packages/" class="md-nav__link">
        R Packages
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_19" type="checkbox" id="__nav_19" >
      
      
      
      
        <label class="md-nav__link" for="__nav_19">
          Other Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other Services" data-md-level="1">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          Other Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Other_Services/Aristotle/" class="md-nav__link">
        Aristotle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Other_Services/UCL_UK_e-Science_Certificates/" class="md-nav__link">
        UCL UK e-Science Certificates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_20" type="checkbox" id="__nav_20" >
      
      
      
      
        <label class="md-nav__link" for="__nav_20">
          Paid-For Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Paid-For Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_20">
          <span class="md-nav__icon md-icon"></span>
          Paid-For Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paid-For_Resources/How_to_Use/" class="md-nav__link">
        How to Use
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paid-For_Resources/Purchasing_in_Myriad/" class="md-nav__link">
        Purchasing in Myriad
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_21" type="checkbox" id="__nav_21" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_21">
          Software Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Software Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_21">
          <span class="md-nav__icon md-icon"></span>
          Software Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ANSYS/" class="md-nav__link">
        ANSYS
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          MATLAB
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        MATLAB
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-node-multi-threaded-batch-jobs" class="md-nav__link">
    Single node multi-threaded batch jobs
  </a>
  
    <nav class="md-nav" aria-label="Single node multi-threaded batch jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-without-the-jvm-to-reduce-overhead" class="md-nav__link">
    Run without the JVM to reduce overhead
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-single-threaded" class="md-nav__link">
    Run single-threaded
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-matlab-gui-interactively" class="md-nav__link">
    Using the MATLAB GUI interactively
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-jobs-using-the-matlab-parallel-server-mps" class="md-nav__link">
    Submitting jobs using the MATLAB Parallel Server (MPS)
  </a>
  
    <nav class="md-nav" aria-label="Submitting jobs using the MATLAB Parallel Server (MPS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importing-the-cluster-profile" class="md-nav__link">
    Importing the cluster profile
  </a>
  
    <nav class="md-nav" aria-label="Importing the cluster profile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-using-matlab-functions" class="md-nav__link">
    Import using MATLAB functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-from-matlab-gui" class="md-nav__link">
    Import from MATLAB GUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables-needed-for-job-submission" class="md-nav__link">
    Environment variables needed for job submission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-a-simple-mps-job" class="md-nav__link">
    Example: a simple MPS job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-a-mps-job-with-more-than-one-input-file" class="md-nav__link">
    Example: a MPS job with more than one input file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    Further reading
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-matlab-jobs-from-your-workstationlaptop" class="md-nav__link">
    Submitting MATLAB jobs from your workstation/laptop
  </a>
  
    <nav class="md-nav" aria-label="Submitting MATLAB jobs from your workstation/laptop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-setup" class="md-nav__link">
    Remote setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submitting-a-job-to-the-cluster" class="md-nav__link">
    Submitting a job to the cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-your-results" class="md-nav__link">
    Viewing your results
  </a>
  
    <nav class="md-nav" aria-label="Viewing your results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#writing-intermediate-results" class="md-nav__link">
    Writing intermediate results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-remote-jobs" class="md-nav__link">
    Troubleshooting remote jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-matlab-on-gpus" class="md-nav__link">
    Running MATLAB on GPUs
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Singularity/" class="md-nav__link">
        Singularity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../R/" class="md-nav__link">
        R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Other_Software/" class="md-nav__link">
        Other Software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Installing_Software/" class="md-nav__link">
        Installing Software
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-node-multi-threaded-batch-jobs" class="md-nav__link">
    Single node multi-threaded batch jobs
  </a>
  
    <nav class="md-nav" aria-label="Single node multi-threaded batch jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-without-the-jvm-to-reduce-overhead" class="md-nav__link">
    Run without the JVM to reduce overhead
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-single-threaded" class="md-nav__link">
    Run single-threaded
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-matlab-gui-interactively" class="md-nav__link">
    Using the MATLAB GUI interactively
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-jobs-using-the-matlab-parallel-server-mps" class="md-nav__link">
    Submitting jobs using the MATLAB Parallel Server (MPS)
  </a>
  
    <nav class="md-nav" aria-label="Submitting jobs using the MATLAB Parallel Server (MPS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importing-the-cluster-profile" class="md-nav__link">
    Importing the cluster profile
  </a>
  
    <nav class="md-nav" aria-label="Importing the cluster profile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-using-matlab-functions" class="md-nav__link">
    Import using MATLAB functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-from-matlab-gui" class="md-nav__link">
    Import from MATLAB GUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables-needed-for-job-submission" class="md-nav__link">
    Environment variables needed for job submission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-a-simple-mps-job" class="md-nav__link">
    Example: a simple MPS job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-a-mps-job-with-more-than-one-input-file" class="md-nav__link">
    Example: a MPS job with more than one input file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    Further reading
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-matlab-jobs-from-your-workstationlaptop" class="md-nav__link">
    Submitting MATLAB jobs from your workstation/laptop
  </a>
  
    <nav class="md-nav" aria-label="Submitting MATLAB jobs from your workstation/laptop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-setup" class="md-nav__link">
    Remote setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submitting-a-job-to-the-cluster" class="md-nav__link">
    Submitting a job to the cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-your-results" class="md-nav__link">
    Viewing your results
  </a>
  
    <nav class="md-nav" aria-label="Viewing your results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#writing-intermediate-results" class="md-nav__link">
    Writing intermediate results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-remote-jobs" class="md-nav__link">
    Troubleshooting remote jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-matlab-on-gpus" class="md-nav__link">
    Running MATLAB on GPUs
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/blob/master/mkdocs-project-dir/docs/Software_Guides/Matlab.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


  <h1>MATLAB</h1>

<p>MATLAB is a numerical computing environment and proprietary programming language developed by MathWorks.</p>
<p>Our MATLAB installs include all the toolboxes included in UCL's Total Academic Headcount-Campus licence plus the MATLAB Parallel Server. We also have the NAG toolbox for Matlab available.</p>
<p>You can submit single node multi-threaded MATLAB jobs, single node
jobs which use the Parallel Computing Toolbox and the MATLAB Parallel
    Server (MPS) and MATLAB GPU jobs. Currently MATLAB jobs can only be run
    on Myriad however we are working with MathWorks to allow the
    submission of multi-node MPS jobs on Kathleen.</p>
<p>You can also submit jobs to Myriad from MATLAB running on your own desktop or laptop.</p>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">§</a></h2>
<p>You need to load MATLAB once from a login node before you can submit any jobs. This allows it to set up your <code>~/.matlab</code> directory as a symbolic link to <code>~/Scratch/.matlab</code> so that the compute nodes can write to it.</p>
<div class="codehilite"><pre><span></span><code># on a login node
module load xorg-utils/X11R7.7
module load matlab/full/r2021a/9.10
</code></pre></div>

<p>We have other versions of MATLAB installed. You can run <code>module avail matlab</code> to see all the available installed versions.</p>
<h2 id="single-node-multi-threaded-batch-jobs">Single node multi-threaded batch jobs<a class="headerlink" href="#single-node-multi-threaded-batch-jobs" title="Permanent link">§</a></h2>
<p>This is the simplest way to start using MATLAB on the cluster.</p>
<p>You will need a .m file containing the MATLAB commands you want to carry out.</p>
<p>Here is an example jobscript which you would submit using the <code>qsub</code> command, after you have loaded the MATLAB module once on a login node as mentioned in <a href="#setup">Setup</a>:</p>
<div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# Batch script to run a multi-threaded MATLAB job under SGE.

# Request ten minutes of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=0:10:0

# Request 1 gigabyte of RAM per core. 
#$ -l mem=1G

# Request 15 gigabytes of TMPDIR space (default is 10 GB)
#$ -l tmpfs=15G

# Request a number of threads (which will use that number of cores). 
# On Myriad you can set the number of threads to a maximum of 36. 
#$ -pe smp 36

# Request one MATLAB licence - makes sure your job doesn&#39;t start 
# running until sufficient licenses are free.
#$ -l matlab=1

# Set the name of the job.
#$ -N Matlab_multiThreadedJob1

# Set the working directory to somewhere in your scratch space.
# This is a necessary step as compute nodes cannot write to $HOME.
# Replace &quot;&lt;your_UCL_id&gt;&quot; with your UCL user ID.
# This directory must already exist.
#$ -wd /home/&lt;your_UCL_id&gt;/Scratch/Matlab_examples

# Your work should be done in $TMPDIR
cd $TMPDIR

module load xorg-utils/X11R7.7
module load matlab/full/r2021a/9.10
# outputs the modules you have loaded
module list

# Optional: copy your script and any other files into $TMPDIR.
# This is only practical if you have a small number of files.
# If you do not copy them in, you must always refer to them using a
# full path so they can be found, eg. ~/Scratch/Matlab_examples/analyse.m

cp ~/Scratch/Matlab_examples/myMatlabJob.m $TMPDIR
cp ~/Scratch/Matlab_examples/initialise.m $TMPDIR
cp ~/Scratch/Matlab_examples/analyse.m $TMPDIR

# These echoes output what you are about to run
echo &quot;&quot;
echo &quot;Running matlab -nosplash -nodisplay &lt; myMatlabJob.m ...&quot;
echo &quot;&quot;

matlab -nosplash -nodesktop -nodisplay &lt; myMatlabJob.m
# Or if you did not copy your files:
# matlab -nosplash -nodesktop -nodisplay &lt; ~/Scratch/Matlab_examples/myMatlabJob.m

# tar up all contents of $TMPDIR back into your space
tar zcvf $HOME/Scratch/Matlab_examples/files_from_job_${JOB_ID}.tgz $TMPDIR

# Make sure you have given enough time for the copy to complete!
</code></pre></div>

<p>Alternative syntax:
Instead of using Unix input redirection like this:</p>
<div class="codehilite"><pre><span></span><code>matlab -nosplash -nodesktop -nodisplay &lt; $Matlab_infile
</code></pre></div>

<p>you can also do:</p>
<div class="codehilite"><pre><span></span><code>matlab -nosplash -nodesktop -nodisplay -r $Matlab_infile
</code></pre></div>

<h3 id="run-without-the-jvm-to-reduce-overhead">Run without the JVM to reduce overhead<a class="headerlink" href="#run-without-the-jvm-to-reduce-overhead" title="Permanent link">§</a></h3>
<p>You can give the <code>-nojvm</code> option to tell MATLAB to run without the Java Virtual Machine. This will speed up startup time, possibly execution time, and remove some memory overhead, but will prevent you using any tools that require Java (eg, tools that use the Java API for I/O and networking like URLREAD, or call Java object methods). </p>
<h3 id="run-single-threaded">Run single-threaded<a class="headerlink" href="#run-single-threaded" title="Permanent link">§</a></h3>
<p>Most of the time, MATLAB will create many threads and use them as it wishes. If you know your job is entirely single-threaded, you can force MATLAB to run with only one thread on one core, which will allow you to have more jobs running at once. </p>
<p>To request one core only, set <code>#$ -pe smp 1</code> in your jobscript.</p>
<p>Run MATLAB like this:</p>
<div class="codehilite"><pre><span></span><code>matlab -nosplash -nodesktop -nodisplay -nojvm -singleCompThread &lt; $Matlab_infile
</code></pre></div>

<p>The <code>-singleCompThread</code> forces MATLAB to run single-threaded, and the <code>-nojvm</code> tells it to run without the Java Virtual Machine, as above. </p>
<h2 id="using-the-matlab-gui-interactively">Using the MATLAB GUI interactively<a class="headerlink" href="#using-the-matlab-gui-interactively" title="Permanent link">§</a></h2>
<p>You can run MATLAB interactively for short amounts of time on the login nodes (please do not do this if your work will be resource-intensive). You can also run it interactively in a <code>qrsh</code> session on the compute nodes.</p>
<p>Launching with <code>matlab</code> will give you the full graphical user interface - you will need to have logged in to the cluster with X-forwarding on for this to work. </p>
<p>Launching with <code>matlab -nodesktop -nodisplay</code> will give you the MATLAB terminal.</p>
<p>[//]: # Up to this point on revision.</p>
<h2 id="submitting-jobs-using-the-matlab-parallel-server-mps">Submitting jobs using the MATLAB Parallel Server (MPS)<a class="headerlink" href="#submitting-jobs-using-the-matlab-parallel-server-mps" title="Permanent link">§</a></h2>
<p>You must have loaded the MATLAB module once from a login node as described in <a href="#setup">Setup</a> before you can submit any MATLAB MPS jobs.</p>
<p>MATLAB PCS jobs must be submitted from an interactive or scripted
Matlab session which can be running on the cluster login nodes, from
another MATLAB job or <a href="#submitting-matlab-jobs-from-your-workstationlaptop">on your own machine</a>.</p>
<p>MATLAB MPS jobs will currently only work inside a single node on our
clusters. On Myriad this means a maximum of 36 workers can be used per
job.</p>
<h3 id="importing-the-cluster-profile">Importing the cluster profile<a class="headerlink" href="#importing-the-cluster-profile" title="Permanent link">§</a></h3>
<p>You need to import the cluster profile into your MATLAB environment and set it as the default before you can submit DCS jobs. This only needs doing once. The imported profile will be saved in your MATLAB settings directory.</p>
<p>Importing the profile can be done either by calling MATLAB functions or via the graphical interface. The profile is stored here (for R2021a): </p>
<div class="codehilite"><pre><span></span><code>/shared/ucl/apps/Matlab/toolbox_local/R2021a/myriad_R2021a.mlsettings
</code></pre></div>

<h4 id="import-using-matlab-functions">Import using MATLAB functions<a class="headerlink" href="#import-using-matlab-functions" title="Permanent link">§</a></h4>
<p>Run these functions from a MATLAB session:</p>
<div class="codehilite"><pre><span></span><code>profile_Myriad = parallel.importProfile (&#39;/shared/ucl/apps/Matlab/toolbox_local/R2021a/myriad_R2021a.mlsettings&#39;);
parallel.defaultClusterProfile (&#39;myriad_R2021a&#39;);
</code></pre></div>

<h4 id="import-from-matlab-gui">Import from MATLAB GUI<a class="headerlink" href="#import-from-matlab-gui" title="Permanent link">§</a></h4>
<p>To import using the graphical interface instead, do this.</p>
<ol>
<li>From the Home tab select the Parallel menu and click <em>Create and Manage Clusters...</em>.</li>
<li>The Cluster Profile Manager window will open.
<img alt="MATLAB Cluster Profile Manager screenshot" src="../../img/MATLAB_ClusterProfBefore.png" /></li>
<li>Select Import and in the <em>Import Profiles from file</em> window navigate to the myriad_R2021a.mlsettings file shown above and select Open.</li>
<li>Select the resulting myriad_R2021a profile and click <em>Set as Default</em>. The Cluster Profile Manager window should now look like this:
<img alt="MATLAB Cluster Profile Manager screenshot after" src="../../img/MATLAB_ClusterProfAfter.png" /></li>
</ol>
<p>In both cases after you exit MATLAB your cluster profile is saved for future use.</p>
<h4 id="environment-variables-needed-for-job-submission">Environment variables needed for job submission<a class="headerlink" href="#environment-variables-needed-for-job-submission" title="Permanent link">§</a></h4>
<p>We have set up four Grid Engine environment variables to assist with job submission from within MATLAB. These are needed to pass in job resource parameters that aren't supported by the internal MATLAB job submission mechanism.</p>
<ul>
<li><code>SGE_CONTEXT</code>: a comma-separated list of variables treated as if added via the <code>-ac</code> option, eg. <code>exclusive</code></li>
<li><code>SGE_OPT</code>: a comma-separated list of resources treated as if added via the <code>-l</code> option, eg. <code>h_rt=0:10:0,mem=1G,tmpfs=15G</code></li>
</ul>
<p>and two project and Gold related variables. Most users will not need to use either of these:</p>
<ul>
<li><code>SGE_PROJECT</code>: a project treated as if added via the <code>-P</code> option.</li>
<li><code>SGE_ACCOUNT</code>: a Gold project as if added via the <code>-A</code> option. When using this your <code>SGE_PROJECT</code> needs to be set to <code>Gold</code>.</li>
</ul>
<p><code>-ac exclusive</code> prevents anything else running on the same node as your job, even if you aren't using all the cores. This is no longer a necessary option for MATLAB jobs.</p>
<p>There are two ways to set these:</p>
<p>1) Before starting your MATLAB session, using the usual Bash method of exporting environment variables:</p>
<div class="codehilite"><pre><span></span><code>export SGE_CONTEXT=exclusive
export SGE_OPT=h_rt=0:15:0,mem=2G,tmpfs=15G
export SGE_PROJECT=&lt;your project ID&gt;
export SGE_ACCOUNT=&lt;your Gold project&gt;
</code></pre></div>

<p>2) Inside your MATLAB session, using MATLAB's <code>setenv</code> function:</p>
<div class="codehilite"><pre><span></span><code>setenv (&#39;SGE_CONTEXT&#39;, &#39;exclusive&#39;);
setenv (&#39;SGE_OPT&#39;, &#39;h_rt=0:15:0,mem=2G,tmpfs=15G&#39;); 
setenv (&#39;SGE_PROJECT&#39;, &#39;&lt;your project ID&gt;&#39;);
setenv (&#39;SGE_ACCOUNT&#39;, &#39;&lt;your Gold project&gt;&#39;);
</code></pre></div>

<h4 id="example-a-simple-mps-job">Example: a simple MPS job<a class="headerlink" href="#example-a-simple-mps-job" title="Permanent link">§</a></h4>
<p>This submits a job from inside a MATLAB session running on a login node. You need to start MATLAB from a directory in Scratch - jobs will inherit this as their working directory.</p>
<p>This is an example where you have only one MATLAB source file.</p>
<p>1) Change to the directory in Scratch you want the job to run from and set the SGE environment variables.</p>
<div class="codehilite"><pre><span></span><code>cd ~/Scratch/Matlab_examples
export SGE_OPT=h_rt=0:10:0,mem=2G,tmpfs=15G
</code></pre></div>

<p>2) Either start the MATLAB GUI:</p>
<div class="codehilite"><pre><span></span><code>matlab
</code></pre></div>

<p>or start a MATLAB terminal session:</p>
<div class="codehilite"><pre><span></span><code>matlab -nodesktop -nodisplay
</code></pre></div>

<p>3) Inside MATLAB, create a cluster object using the cluster profile:</p>
<div class="codehilite"><pre><span></span><code>c = parcluster (&#39;myriad_R2021a&#39;);
</code></pre></div>

<p>4) Use your cluster object to create a job object of the type you need. For this example the job is a parallel job with communication between MATLAB workers of type "Single Program Multiple Data":</p>
<div class="codehilite"><pre><span></span><code>myJob = createCommunicatingJob (c, &#39;Type&#39;, &#39;SPMD&#39;);
</code></pre></div>

<p>5) Set the number of workers:</p>
<div class="codehilite"><pre><span></span><code>num_workers = 8;
</code></pre></div>

<p>The maximum value you can set here on Myriad is 36.</p>
<p>6) Tell the job the files needed to be made available to each worker - in this example there is only one file:</p>
<div class="codehilite"><pre><span></span><code>myJob.AttachedFiles = {&#39;colsum.m&#39;};
</code></pre></div>

<p><code>colsum.m</code> contains the simple magic square example from the MATLAB manual "Parallel Computing Toolbox User's Guide". </p>
<p>7) Set the minimum and maximum number of workers for the job (we are asking for an exact number here by setting them the same):</p>
<div class="codehilite"><pre><span></span><code>myJob.NumWorkersRange = [num_workers, num_workers];
</code></pre></div>

<p>8) Create a MATLAB task to be executed as part of the job. Here it consists of executing the MATLAB function <code>colsum</code>. The other arguments say that the task returns one parameter and there are no input arguments to the <code>colsum</code> function:</p>
<div class="codehilite"><pre><span></span><code>task = createTask (myJob, @colsum, 1, {});
</code></pre></div>

<p>9) Submit the job:</p>
<div class="codehilite"><pre><span></span><code>submit (myJob);
</code></pre></div>

<p>Your job is now submitted to the scheduler and you can see its queue status in <code>qstat</code> as normal. If you were using the MATLAB GUI you can also monitor jobs by selecting <em>Monitor Jobs</em> from the <em>Parallel</em> menu on the <em>Home</em> tab.</p>
<p>10) When the job has completed get the results using:</p>
<div class="codehilite"><pre><span></span><code>results = fetchOutputs(myJob)
</code></pre></div>

<p>You can access the job log from MATLAB using:</p>
<div class="codehilite"><pre><span></span><code>logMess = getDebugLog (c, myJob);
</code></pre></div>

<h4 id="example-a-mps-job-with-more-than-one-input-file">Example: a MPS job with more than one input file<a class="headerlink" href="#example-a-mps-job-with-more-than-one-input-file" title="Permanent link">§</a></h4>
<p>This example has several input files. The job type is "MATLAB Pool". A "Pool" job runs the specified task function with a MATLAB pool available to run the body of parfor loops or spmd blocks and is the default job type. This example was kindly supplied to assist in testing MATLAB by colleagues from CoMPLEX. </p>
<p>The first part of creating the job is the same as the above example apart from the longer runtime and larger amount of memory per core: </p>
<p>1)  Change into a directory in Scratch, set the SGE variables and launch MATLAB:</p>
<div class="codehilite"><pre><span></span><code>cd ~/Scratch/Matlab_examples
export SGE_OPT=h_rt=1:0:0,mem=4G,tmpfs=15G
matlab
</code></pre></div>

<p>to launch the GUI or:</p>
<div class="codehilite"><pre><span></span><code>matlab -nodesktop -nodisplay
</code></pre></div>

<p>to start a terminal session. </p>
<div class="codehilite"><pre><span></span><code>c = parcluster (&#39;myriad_R2021a&#39;);
</code></pre></div>

<p>2) Using our cluster object create a job object of type "Pool":</p>
<div class="codehilite"><pre><span></span><code>myJob2 = createCommunicatingJob (c, &#39;Type&#39;, &#39;Pool&#39;);
</code></pre></div>

<p>3) Set the number of workers and another variable used by the example:</p>
<div class="codehilite"><pre><span></span><code>num_workers = 8;
simulation_duration_ms = 1000;
</code></pre></div>

<p>4) Tell the job all the input files needed to be made available to each worker as a cell array:</p>
<div class="codehilite"><pre><span></span><code>myJob2.AttachedFiles = {
&#39;AssemblyFiniteDifferencesMatrix.m&#39;
&#39;AssemblyFiniteDifferencesRightHandSide.m&#39;
&#39;CellModelsComputeIonicCurrents.m&#39;
&#39;CellModelsGetVoltage.m&#39;
&#39;CellModelsInitialise.m&#39;
&#39;CellModelsSetVoltage.m&#39;
&#39;GetStimuliForTimeStep.m&#39;
&#39;SubmitMonodomainJob.m&#39;
&#39;RegressionTest.m&#39;
&#39;RunAndVisualiseMonodomainSimulation.m&#39;
&#39;SolveLinearSystem.m&#39;
&#39;luo_rudy_1991_iionic.m&#39;
&#39;luo_rudy_1991_time_deriv.m&#39;};
</code></pre></div>

<p>5) Set the minimum and maximum number of workers for the job:</p>
<div class="codehilite"><pre><span></span><code>myJob2.NumWorkersRange = [num_workers, num_workers];
</code></pre></div>

<p>6) Create a MATLAB task to be executed as part of the job. For this example it will consist of executing the MATLAB function <code>RunAndVisualiseMonodomainSimulation</code>. The rest of the arguments indicate that the task returns three parameters and there are five input arguments to the function. These are passed as a cell array:</p>
<div class="codehilite"><pre><span></span><code>task = createTask (myJob2, @RunAndVisualiseMonodomainSimulation, 3, {5000, simulation_duration_ms, 1.4, 1.4, false});
</code></pre></div>

<p>7) Submit the job:</p>
<div class="codehilite"><pre><span></span><code>submit (myJob2);
</code></pre></div>

<p>As before use <code>fetchOutputs</code> to collect the results.</p>
<p>If you closed your session, you can get your results by:</p>
<div class="codehilite"><pre><span></span><code>c = parcluster (&#39;myriad_R2021a&#39;);                  # get a cluster object
jobs = findJob(c)                                  # get a list of jobs submitted to that cluster
job = jobs(3);                                     # pick a particular job
results = fetchOutputs(job)
</code></pre></div>

<p>You can get other information: <code>diary(job)</code> will give you the job diary, and <code>load(job)</code> will load the workspace. </p>
<h4 id="further-reading">Further reading<a class="headerlink" href="#further-reading" title="Permanent link">§</a></h4>
<p>There is a lot more information about using the MATLAB Distributed Computing Server in the MATLAB manual: <a href="https://uk.mathworks.com/help/distcomp/index.html">Parallel Computing Toolbox User’s Guide</a>.</p>
<h2 id="submitting-matlab-jobs-from-your-workstationlaptop">Submitting MATLAB jobs from your workstation/laptop<a class="headerlink" href="#submitting-matlab-jobs-from-your-workstationlaptop" title="Permanent link">§</a></h2>
<p>You can submit MATLAB jobs to Myriad from MATLAB sessions running on your own desktop workstation or laptop systems provided they are running the same version of MATLAB and your computer is within the UCL firewall. </p>
<p>With MATLAB R2021a you can currently submit jobs to Myriad. Support for R2018b is also still available. </p>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">§</a></h3>
<ol>
<li>You must already have an account on the clusters!</li>
<li>Have MATLAB R2021a (or R2018b) installed on your local workstation/laptop. The local version must match the version running jobs. MATLAB R2021a can be downloaded from the <a href="http://swdb.ucl.ac.uk/package/view/id/2?filter=Matlab">UCL Software Database</a>.</li>
<li>Your local workstation/laptop installation of MATLAB must include the Parallel Computing toolbox. This is included in the UCL TAH MATLAB license and may be installed automatically.
 Home tab &gt; Add-Ons &gt; Get Add-Ons
 You will find the Parallel Computing Toolbox in the Workflows category.</li>
<li>If your local workstation/laptop is not directly connected to the UCL network (at home for example), you need to have the <a href="https://www.ucl.ac.uk/isd/services/get-connected/remote-working-services/ucl-virtual-private-network-vpn">UCL VPN client</a> installed and running on it.</li>
</ol>
<h3 id="remote-setup">Remote setup<a class="headerlink" href="#remote-setup" title="Permanent link">§</a></h3>
<p>1) On the cluster you are using (Myriad in this case) create a directory to hold remotely submitted job details. For example:</p>
<div class="codehilite"><pre><span></span><code>mkdir ~/Scratch/Matlab_remote_jobs
</code></pre></div>

<p>This directory needs to be in your Scratch directory as compute nodes need to be able to write to it. You should not use this directory for anything else.</p>
<p>2) On your local workstation/laptop create a directory to hold information about jobs that have been submitted to the cluster. Again you should not use this directory for anything else.</p>
<p>3) Download either the the <a href="../matlab_resources/Myriad_submit_R2021a.zip">support files for remote submission to Myriad for R2021a</a> or <a href="../matlab_resources/Myriad_submit_R2018b.zip">support files for remote submission to Myriad for R2018b</a>. Make sure you download the correct one for your version of MATLAB!</p>
<p>4) This step <strong>MUST</strong> be done while Matlab is shut down. Unzip the archive into MATLAB's local toolbox directory. Default locations for the local toolbox directory are:</p>
<ul>
<li>Linux:
The default local toolbox location is <code>/usr/local/MATLAB/R2021a/toolbox/local</code> for R2021a. Navigate to this directory and use <code>unzip -x archive_name</code>. </li>
<li>Mac OS X:
The default local toolbox location is <code>/Applications/MATLAB_R2021a.app/toolbox/local</code> for R2021a. In order to view or change the contents of an application package, open <code>/Applications</code> in a Finder window. Then right-click the application and select "View Package Contents." Then navigate to the appropriate directory. Note: if you don't have access to <code>/Applications/MATLAB_R2021a.app/toolbox/local</code>, you can unzip the support files into <code>~/Documents/MATLAB/</code> instead. </li>
<li>Windows:
The default local toolbox location is <code>C:\Program Files\MATLAB\R2021a\toolbox\local</code> for R2021a. Extract the archive here. You can unzip the support files into <code>Documents\MATLAB\</code> instead.</li>
</ul>
<p>5) Download the <a href="../matlab_resources/parallelProfileMyriad.m">parallelProfileMyriad function</a>  to your local workstation/laptop. It will need to be unzipped. This function create a cluster profile for Myriad for R2021a or R2018b.</p>
<p>6) Start MATLAB, navigate to where you saved the <code>parallelProfileMyriad.m</code> file and run the function by typing:</p>
<div class="codehilite"><pre><span></span><code>parallelProfileMyriad
</code></pre></div>

<p>at your MATLAB prompt (in your MATLAB Command Window if running the MATLAB GUI) and answer the questions.</p>
<h3 id="submitting-a-job-to-the-cluster">Submitting a job to the cluster<a class="headerlink" href="#submitting-a-job-to-the-cluster" title="Permanent link">§</a></h3>
<p>1) You need to set the <a href="#environment-variables-needed-for-job-submission">Grid Engine support environment variables</a> on your local computer.
Eg. in your MATLAB session set:</p>
<div class="codehilite"><pre><span></span><code>setenv (&#39;SGE_CONTEXT&#39;, &#39;exclusive&#39;);                # optional
setenv (&#39;SGE_OPT&#39;, &#39;h_rt=0:15:0,mem=2G,tmpfs=15G&#39;); 
setenv (&#39;SGE_PROJECT&#39;, &#39;&lt;your project ID&gt;&#39;);        # optional
setenv (&#39;SGE_ACCOUNT&#39;, &#39;&lt;your Gold project&gt;&#39;);      # optional
</code></pre></div>

<p>2) In your MATLAB session create a cluster object using the cluster profile created by the <code>parallelProfile...</code> functions. For Myriad:</p>
<div class="codehilite"><pre><span></span><code>c = parcluster (&#39;myriad_R2021a&#39;);
</code></pre></div>

<p>3) You can now create and submit jobs in a similar way to that shown in the MPS examples above starting from step 4 in the <a href="#example-a-simple-dcs-job">simple MPS job example</a> or step 2 in the <a href="#example-a-dcs-job-with-more-than-one-input-file">MPS job with multiple input files example</a>.</p>
<h3 id="viewing-your-results">Viewing your results<a class="headerlink" href="#viewing-your-results" title="Permanent link">§</a></h3>
<p>After submitting your job remotely from your desktop, you can close MATLAB and come back later. To see your jobs:</p>
<p>Click "Parallel &gt; Monitor jobs"</p>
<p>This will bring up the job monitor where you can see the status of your jobs and whether they are finished. MATLAB numbers the jobs sequentially.</p>
<p>Right-click on a job and choose "fetch outputs".</p>
<p>This is what will be executed (for job4 on Myriad):</p>
<div class="codehilite"><pre><span></span><code>myCluster = parcluster(&#39;myriad_R2021a&#39;);
job4 = myCluster.findJob(&#39;ID&#39;,4);
job4_output = fetchOutputs(job4);
</code></pre></div>

<p>The Workspace will show the available data and you can view your results. The data is fetched from the <code>Matlab_remote_jobs</code> directory you created on Myriad (or Legion) in <a href="#remote-setup">Remote setup</a> step 1, so that will also have files and directories in it called job1, job2 and so on.</p>
<p>If you have already fetched the data, you can view the results straight away by selecting that job. If you need to reload everything, you can right-click on the job and the option will be to load variables instead. </p>
<h4 id="writing-intermediate-results">Writing intermediate results<a class="headerlink" href="#writing-intermediate-results" title="Permanent link">§</a></h4>
<p>If you want to explicitly write out intermediate results, you need to provide a full path to somewhere in Scratch otherwise MATLAB will try to write them in your home, which isn't writable by the compute nodes. </p>
<h3 id="troubleshooting-remote-jobs">Troubleshooting remote jobs<a class="headerlink" href="#troubleshooting-remote-jobs" title="Permanent link">§</a></h3>
<p>If you get a message like this when retrieving your outputs then something has gone wrong in your job:</p>
<div class="codehilite"><pre><span></span><code>Task with ID xxx returned 0 outputs but 1 were expected
</code></pre></div>

<p>You need to retrieve the debug log to find out what happened. Example:</p>
<div class="codehilite"><pre><span></span><code>myCluster = parcluster(&#39;myriad_R2021a&#39;);
job4 = myCluster.findJob(&#39;ID&#39;,4);

jobLog = getDebugLog (myCluster, job4);
jobLog
</code></pre></div>

<p>There will be a lot of output. Look for lines related to errors happening in your own code.</p>
<h2 id="running-matlab-on-gpus">Running MATLAB on GPUs<a class="headerlink" href="#running-matlab-on-gpus" title="Permanent link">§</a></h2>
<p>This uses MATLAB's <a href="https://uk.mathworks.com/help/distcomp/examples/illustrating-three-approaches-to-gpu-computing-the-mandelbrot-set.html">Mandelbrot Set GPU example</a>.</p>
<div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# Batch script to run a GPU MATLAB job on Myriad.

# Request 15 minutes of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=0:15:0

# Request 2 gigabytes of RAM per core.
#$ -l mem=2G

# Request 15 gigabytes of TMPDIR space (default is 10 GB)
#$ -l tmpfs=15G

# Request 1 GPU
#$ -l gpu=1

# Request 1 CPU core. (Max on Myriad is 36)
#$ -pe smp 1

# Request one MATLAB licence - makes sure your job doesn&#39;t start 
# running until sufficient licenses are free.
#$ -l matlab=1

# Set the name of the job.
#$ -N Matlab_GPU_Job1

# Set the working directory to somewhere in your scratch space.
# This is a necessary step as compute nodes cannot write to $HOME.
# Replace &quot;&lt;your_UCL_id&gt;&quot; with your UCL user ID.
# This directory must already exist.
#$ -wd /home/&lt;your_UCL_id&gt;/Scratch/Matlab_examples

# Your work should be done in $TMPDIR
cd $TMPDIR

# Optional: Copy your script and any other files into $TMPDIR.
# If not, you must always refer to them using a full path.
cp /home/ccaabaa/Software/Matlab/Mandelbrot_GPU.m $TMPDIR

module unload compilers mpi
module load compilers/gnu/4.9.2
module load xorg-utils/X11R7.7
module load matlab/full/r2021a/9.10
module list

# These echoes output what you are about to run
echo &quot;&quot;
echo &quot;Running matlab -nosplash -nodisplay &lt; Mandelbrot_GPU.m ...&quot;
echo &quot;&quot;
matlab -nosplash -nodesktop -nodisplay &lt; Mandelbrot_GPU.m

# tar up all contents of $TMPDIR back into your space
tar zcvf $HOME/Scratch/Matlab_examples/files_from_job_${JOB_ID}.tgz $TMPDIR

# Make sure you have given enough time for the copy to complete!
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../ANSYS/" class="md-footer__link md-footer__link--prev" aria-label="Previous: ANSYS" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              ANSYS
            </div>
          </div>
        </a>
      
      
        
        <a href="../Singularity/" class="md-footer__link md-footer__link--next" aria-label="Next: Singularity" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Singularity
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2020 UCL Research Computing Group
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/UCL-RITS" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.cefbb252.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.17f42bbf.min.js"></script>
      
    
  </body>
</html>