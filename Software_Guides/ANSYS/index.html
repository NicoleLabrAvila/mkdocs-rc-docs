



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the centrally provided Research Computing HPC services at UCL.">
      
      
        <link rel="canonical" href="https://www.rc.ucl.ac.uk/docs/Software_Guides/ANSYS/">
      
      
        <meta name="author" content="UCL RCAS Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>ANSYS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/tweaks.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ansys" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.rc.ucl.ac.uk/docs/" title="UCL Research Computing Documentation" aria-label="UCL Research Computing Documentation" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../../img/portico.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              UCL Research Computing Documentation
            </span>
            <span class="md-header-nav__topic">
              
                ANSYS
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.rc.ucl.ac.uk/docs/" title="UCL Research Computing Documentation" class="md-nav__button md-logo">
      
        <img alt="logo" src="../../img/portico.svg" width="48" height="48">
      
    </a>
    UCL Research Computing Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Account_Services/" title="Account Services" class="md-nav__link">
      Account Services
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Additional_Resource_Requests/" title="Additional Resource Requests" class="md-nav__link">
      Additional Resource Requests
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Contact_Us/" title="Contact and Support" class="md-nav__link">
      Contact and Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Example_Jobscripts/" title="Example Jobscripts" class="md-nav__link">
      Example Jobscripts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Experienced_Users/" title="Quick Start Guide for Experienced HPC Users" class="md-nav__link">
      Quick Start Guide for Experienced HPC Users
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Job_Results/" title="Where do my results go?" class="md-nav__link">
      Where do my results go?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../New_Users/" title="Guide for New Users" class="md-nav__link">
      Guide for New Users
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Planned_Outages/" title="Planned Outages" class="md-nav__link">
      Planned Outages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Terms_and_Conditions/" title="Terms and Conditions" class="md-nav__link">
      Terms and Conditions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../UCL_Service_For_Me/" title="UCL Service For Me" class="md-nav__link">
      UCL Service For Me
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../howto/" title="How do I?" class="md-nav__link">
      How do I?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Background/Cluster_Computing/" title="Cluster Computing" class="md-nav__link">
      Cluster Computing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Clusters
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Clusters
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clusters/Myriad/" title="Myriad" class="md-nav__link">
      Myriad
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clusters/Legion/" title="Legion" class="md-nav__link">
      Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clusters/Grace/" title="Grace" class="md-nav__link">
      Grace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clusters/Kathleen/" title="Kathleen" class="md-nav__link">
      Kathleen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clusters/Thomas/" title="MMM Thomas" class="md-nav__link">
      MMM Thomas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clusters/Michael/" title="MMM Michael" class="md-nav__link">
      MMM Michael
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      Installed Software Lists
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        Installed Software Lists
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Installed_Software_Lists/module-packages/" title="General Software Lists" class="md-nav__link">
      General Software Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Installed_Software_Lists/python-packages/" title="Python Packages" class="md-nav__link">
      Python Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Installed_Software_Lists/r-packages/" title="R Packages" class="md-nav__link">
      R Packages
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      Other Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        Other Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Other_Services/Aristotle/" title="Aristotle" class="md-nav__link">
      Aristotle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Other_Services/UCL_UK_e-Science_Certificates/" title="UCL UK e-Science Certificates" class="md-nav__link">
      UCL UK e-Science Certificates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      Paid-For Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        Paid-For Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Paid-For_Resources/How_to_Use/" title="How to Use" class="md-nav__link">
      How to Use
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Paid-For_Resources/Purchasing_in_Myriad/" title="Purchasing in Myriad" class="md-nav__link">
      Purchasing in Myriad
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18" checked>
    
    <label class="md-nav__link" for="nav-18">
      Software Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        Software Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        ANSYS
      </label>
    
    <a href="./" title="ANSYS" class="md-nav__link md-nav__link--active">
      ANSYS
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ansyscfx" class="md-nav__link">
    ANSYS/CFX
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-single-node-multi-threaded-ansyscfx-jobscript" class="md-nav__link">
    Example single node multi-threaded ANSYS/CFX jobscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-multi-node-mpi-ansyscfx-jobscript" class="md-nav__link">
    Example multi-node MPI ANSYS/CFX jobscript
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-cfx-with-mpi-on-myriad" class="md-nav__link">
    Running CFX with MPI on Myriad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-cfx" class="md-nav__link">
    Troubleshooting CFX
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansysfluent" class="md-nav__link">
    ANSYS/Fluent
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-serial-ansysfluent-jobscript" class="md-nav__link">
    Example serial ANSYS/Fluent jobscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-parallel-mpi-ansysfluent-jobscript" class="md-nav__link">
    Example parallel (MPI) ANSYS/Fluent jobscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-fluent" class="md-nav__link">
    Troubleshooting Fluent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansys-mechanical" class="md-nav__link">
    ANSYS Mechanical
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Matlab/" title="MATLAB" class="md-nav__link">
      MATLAB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Singularity/" title="Singularity" class="md-nav__link">
      Singularity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Other_Software/" title="Other Software" class="md-nav__link">
      Other Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/" title="R" class="md-nav__link">
      R
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ansyscfx" class="md-nav__link">
    ANSYS/CFX
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-single-node-multi-threaded-ansyscfx-jobscript" class="md-nav__link">
    Example single node multi-threaded ANSYS/CFX jobscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-multi-node-mpi-ansyscfx-jobscript" class="md-nav__link">
    Example multi-node MPI ANSYS/CFX jobscript
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-cfx-with-mpi-on-myriad" class="md-nav__link">
    Running CFX with MPI on Myriad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-cfx" class="md-nav__link">
    Troubleshooting CFX
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansysfluent" class="md-nav__link">
    ANSYS/Fluent
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-serial-ansysfluent-jobscript" class="md-nav__link">
    Example serial ANSYS/Fluent jobscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-parallel-mpi-ansysfluent-jobscript" class="md-nav__link">
    Example parallel (MPI) ANSYS/Fluent jobscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-fluent" class="md-nav__link">
    Troubleshooting Fluent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansys-mechanical" class="md-nav__link">
    ANSYS Mechanical
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/UCL-RITS/mkdocs-rc-docs/blob/master/mkdocs-project-dir/docs/Software_Guides/ANSYS.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="ansys">ANSYS<a class="headerlink" href="#ansys" title="Permanent link">§</a></h1>
<p>ANSYS/CFX and ANSYS/Fluent are commercial fluid dynamics packages. </p>
<p>ANSYS/CFX and ANSYS/Fluent version 17.2, 18.0, 19.1 and later are available. The ANSYS Electromagnetics Suite (AnsysEM) is available from version 19.1 onwards. ANSYS Mechanical and Autodyn are available from 2019.r3 onwards.</p>
<p>Before these applications can be run, the user needs to go though a
number of set up steps. These are detailed here.</p>
<p>To see the versions available, type</p>
<div class="codehilite"><pre><span></span><code>module avail ansys
</code></pre></div>


<p>The desired ANSYS module needs to be loaded by issuing a command like:</p>
<div class="codehilite"><pre><span></span><code>module load ansys/19.1
</code></pre></div>


<p>The first time this is done, users should run the shell script
<code>setup_cfx.sh</code> to configure licensing and HP-MPI options on a login
node: </p>
<div class="codehilite"><pre><span></span><code>setup_cfx.sh
</code></pre></div>


<p>Running this script is required regardless of which ANSYS application you are running..</p>
<p>The ANSYS applications are intended to be run primarily within batch
jobs however you may run short (less than 5 minutes execution time)
interactive tests on the Login Nodes and longer (up to two hours) on the
User Test Nodes. Interactive work can be done using the ANSYS
interactive tools provided you have X-windows functionality enabled
though your ssh connection. See our User Guide
for more information about enabling
X-windows functionality and the User Test nodes.</p>
<p>UCL's campus-wide license covers 125 instances with 512 HPC licenses (for parallel jobs) available for running CFX, Fluent and AnsysEM jobs and in order to make sure that jobs only run if there are licenses available, it is necessary for users to request ANSYS licenses with their jobs, by adding <code>-ac app=cfx</code> to their job submission.</p>
<h2 id="ansyscfx">ANSYS/CFX<a class="headerlink" href="#ansyscfx" title="Permanent link">§</a></h2>
<p>CFX handles its own parallelisation, so a number of complex options need to be passed in job scripts to make it run correctly.</p>
<h3 id="example-single-node-multi-threaded-ansyscfx-jobscript">Example single node multi-threaded ANSYS/CFX jobscript<a class="headerlink" href="#example-single-node-multi-threaded-ansyscfx-jobscript" title="Permanent link">§</a></h3>
<p>Here is an example runscript for running <code>cfx5solve</code> multi-threaded on a
given <code>.def</code> file.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# ANSYS 19.1: Batch script to run cfx5solve on the StaticMixer.def example 
# file, single node multi-threaded (12 threads),

# Force bash as the executing shell.

#$ -S /bin/bash

# Request 15 munutes of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=0:15:0

# Request 1 gigabyte of RAM per core.
#$ -l mem=1G

# Set the name of the job.
#$ -N StaticMixer_thread_12

# Select 12 threads.
#$ -pe smp 12

# Request ANSYS licences 
#$ -ac app=cfx

# Set the working directory to somewhere in your scratch space. In this
# case the subdirectory cfxtests-19.1
#$ -wd /home/&lt;your_UCL_id&gt;/Scratch/cfxtests-19.1

# Load the ANSYS module to set up your environment

module load ansys/19.1

# Copy the .def file into the working (current) directory

cp /home/&lt;your userid&gt;/cfx_examples/StaticMixer.def .

# Run cfx5solve - Note: -max-elapsed-time needs to be set to the same
# time as defined by 2 above.

cfx5solve -max-elapsed-time &quot;15 [min]&quot; -def StaticMixer.def -par-local -partition $OMP_NUM_THREADS
</code></pre></div>
</td></tr></table>

<p>You will need to change the <code>-wd /home/&lt;your_UCL_id&gt;/Scratch/cfxtests-19.1</code> location and may need to change the memory, wallclock time, number of threads and job name directives as well. Replace the .def file with your one and modify the -max-elapsed-time value if needed. The simplest form of qsub command can be used to submit the job eg:</p>
<div class="codehilite"><pre><span></span><code>qsub run-StaticMixer-thr.sh
</code></pre></div>


<p>Output files will be saved in the job's working directory.</p>
<h3 id="example-multi-node-mpi-ansyscfx-jobscript">Example multi-node MPI ANSYS/CFX jobscript<a class="headerlink" href="#example-multi-node-mpi-ansyscfx-jobscript" title="Permanent link">§</a></h3>
<p>Here is an example runscript for running cfx5solve on more than one node
(using MPI) on a given .def file.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# ANSYS 19.1: Batch script to run cfx5solve on the StaticMixer.def example 
# file, distributed parallel (36 cores).

# Request one hour of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=1:00:0

# Request 2 gigabyte of RAM per core.
#$ -l mem=2G

# Set the name of the job.
#$ -N StaticMixer_P_dist_36

# Select the MPI parallel environment and 36 processors.
#$ -pe mpi 36

# Request ANSYS licences 
#$ -ac app=cfx

# Set the working directory to somewhere in your scratch space.  In this
# case the subdirectory cfxtests-19.1
#$ -wd /home/&lt;your_UCL_userid&gt;/Scratch/cfxtests-19.1

# Load the ANSYS module to set up your environment

module load ansys/19.1

# Copy the .def file into the working (current) directory

cp /home/&lt;your_UCL_userid&gt;/cfx_examples/StaticMixer.def .

# SGE puts the machine file in $TMPDIR/machines. Use this to generate the 
# string CFX_NODES needed by cfx5solve

export CFX_NODES=$(cfxnodes $TMPDIR/machines)

# Run cfx5solve - Note: -max-elapsed-time needs to be set to the same
# time as defined by 2 above.

cfx5solve -max-elapsed-time &quot;60 [min]&quot; -def StaticMixer.def -par-dist $CFX_NODES
</code></pre></div>
</td></tr></table>

<p>Please copy if you wish and edit it to suit your jobs. You will
need to change the <code>-wd /home/&lt;your_UCL_userid&gt;/Scratch/cfxtests-19.1</code> location and may need
to change the memory, wallclock time, number of MPI processors
and job name directives as well. Replace the <code>.def</code> file with
your one and modify the <code>-max-elapsed-time</code> value if needed. The
simplest form of qsub command can be used to submit the job eg:</p>
<div class="codehilite"><pre><span></span><code>qsub run-StaticMixer-par.sh
</code></pre></div>


<p>Output files will be saved in the job's working directory.</p>
<h4 id="running-cfx-with-mpi-on-myriad">Running CFX with MPI on Myriad<a class="headerlink" href="#running-cfx-with-mpi-on-myriad" title="Permanent link">§</a></h4>
<p>The default supplied Intel MPI doesn't work on Myriad. Instead you need to use the supplied IBM MPI. This can be done by adding: <code>-start-method "IBM MPI Distributed Parallel"</code> to the <code>cfx5solve</code> command.</p>
<h3 id="troubleshooting-cfx">Troubleshooting CFX<a class="headerlink" href="#troubleshooting-cfx" title="Permanent link">§</a></h3>
<p>If you are getting licensing errors when trying to run a parallel job and you have an older version's <code>~/.ansys/v161/licensing/license.preferences.xml</code> file, delete it. It does not work with the newer license server. (This applies to all older versions, not just <code>v161</code>).</p>
<h2 id="ansysfluent">ANSYS/Fluent<a class="headerlink" href="#ansysfluent" title="Permanent link">§</a></h2>
<p>Fluent handles its own parallelisation, so a number of
complex options need to be passed in job scripts to make it run
correctly.</p>
<p>The .in file mentioned in the scripts below is a <a href="https://www.cfd-online.com/Wiki/Fluent_FAQ#Journal_File_and_Text_User_Interface_.28TUI.29_Related">Fluent journal file</a>, giving it the list of commands to carry out in batch mode.</p>
<h3 id="example-serial-ansysfluent-jobscript">Example serial ANSYS/Fluent jobscript<a class="headerlink" href="#example-serial-ansysfluent-jobscript" title="Permanent link">§</a></h3>
<p>Here is an example jobscript for running Fluent in serial mode (1 core).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# ANSYS 19.1: Batch script to run ANSYS/fluent in serial mode 
# (1 core). 

# Request 2 hours of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=2:0:0

# Request 2 gigabytes of RAM.
#$ -l mem=2G

# Set the name of the job.
#$ -N Fluent_ser1

# Request ANSYS licences
#$ -ac app=cfx

# Set the working directory to somewhere in your scratch space.  In this
# case the subdirectory fluent-tests-19.1
#$ -wd /home/&lt;your_UCL_userid&gt;/Scratch/fluent-tests-19.1

# Load the ANSYS module to set up your environment

module load ansys/19.1

# Copy Fluent input files into the working (current) directory

cp &lt;path to your input files&gt;/test-1.cas .
cp &lt;path to your input files&gt;/test-1.in .

# Run fluent in 2D single precision (-g no GUI). For double precision use
# 2ddp. For 3D use 3d or 3ddp. 

fluent 2d -g &lt; test-1.in
</code></pre></div>
</td></tr></table>

<p>Please copy if you wish and edit it to suit your jobs. You will need to
change the <code>-wd /home/&lt;your_UCL_id&gt;/Scratch/fluent-tests-19.1</code> 
location and may
need to change the memory, wallclock time, and job name as
well. Replace the <code>.cas</code> and <code>.in</code> files with your ones. The
simplest form of qsub command can be used to submit the job eg:</p>
<div class="codehilite"><pre><span></span><code>qsub run-ANSYS-fluent-ser.sh
</code></pre></div>


<p>Output files will be saved in the job's working directory.</p>
<h3 id="example-parallel-mpi-ansysfluent-jobscript">Example parallel (MPI) ANSYS/Fluent jobscript<a class="headerlink" href="#example-parallel-mpi-ansysfluent-jobscript" title="Permanent link">§</a></h3>
<p>Here is an example runscript for running Fluent in parallel potentially
across more than one node.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# ANSYS 19.1: Batch script to run ANSYS/fluent distributed parallel 
# (32 cores). 

# Request 2 hours of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=2:0:0

# Request 2 gigabytes of RAM per core.
#$ -l mem=2G

# Set the name of the job.
#$ -N Fluent_par32

# Select the MPI parallel environment and 32 processors.
#$ -pe mpi 32

# Request 25 Gb TMPDIR space (if on a cluster that supports this)
#$ -l tmpfs=25G

# Request ANSYS licences
#$ -ac app=cfx

# Set the working directory to somewhere in your scratch space.  In this
# case the subdirectory fluent-tests-19.1
#$ -wd /home/&lt;your_UCL_userid&gt;/Scratch/fluent-tests-19.1

# Load the ANSYS module to set up your environment

module load ansys/19.1

# Copy Fluent input files into the working (current) directory

cp &lt;path to your input files&gt;/test-1.cas .
cp &lt;path to your input files&gt;/test-1.in .

# Run fluent  in 3D single precision (-g no GUI). For double precision use
# 3ddp. For 2D use 2d or 2ddp. 
# Do not change -t, -mpi, -pinfiniband and -cnf options.

fluent 3ddp -t$NSLOTS -mpi=ibmmpi -cnf=$TMPDIR/machines -g &lt; test-1.in
</code></pre></div>
</td></tr></table>

<p>Please copy if you wish and edit it to suit your jobs. You will
need to change the <code>-wd /home/&lt;your_UCL_id&gt;/Scratch/fluent-tests-19.1</code> location and may
need to change the memory, wallclock time, number of MPI processors
and job name as well. Replace the <em>.cas</em> and <em>.in</em>
files with your ones. The simplest form of qsub command can
be used to submit the job eg: </p>
<div class="codehilite"><pre><span></span><code>qsub run-ANSYS-fluent-par-32.sh
</code></pre></div>


<p>Output files will be saved in the job's working directory.</p>
<h3 id="troubleshooting-fluent">Troubleshooting Fluent<a class="headerlink" href="#troubleshooting-fluent" title="Permanent link">§</a></h3>
<p>If you are getting licensing errors when trying to run a parallel job and you have an older version's <code>~/.ansys/v161/licensing/license.preferences.xml</code> file, delete it. It does not work with the newer license server. (This applies to all older versions, not just <code>v161</code>).</p>
<p>Fluent 14 required <code>-mpi=pcmpi -pinfiniband</code> in the parallel options: if you have older scripts remember to remove this.</p>
<h2 id="ansys-mechanical">ANSYS Mechanical<a class="headerlink" href="#ansys-mechanical" title="Permanent link">§</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>#!/bin/bash -l

# ANSYS 2019.R3: Batch script to run ANSYS Mechanical solver
# file, distributed parallel (32 cores).

# Using ANSYS 2019 licence manager running on UCL central licence server.

# Force bash as the executing shell.
#$ -S /bin/bash

# Request one hour of wallclock time (format hours:minutes:seconds).
#$ -l h_rt=1:00:0

# Request 2 gigabyte of RAM per core. (Must be an integer)
#$ -l mem=2G

# Set the name of the job.
#$ -N Mech_P_dist_32

# Select the MPI parallel environment and 32 processors.
#$ -pe mpi 32

# Request ANSYS licences $ inserted so currently active.Job will queue until
# suficient licences are available.
#$ -ac app=cfx

# Set the working directory to somewhere in your scratch space.  In this
# case the subdirectory ANSYS_Mech
#$ -wd /home/&lt;your_UCL_username&gt;/Scratch/ANSYS_Mech

# Load the ANSYS module to set up your environment
module load ansys/2019.r3

# Copy the .in file into the working (current) directory
cp ~/ANSYS/steady_state_input_file.dat .

# SGE puts the machine file in $TMPDIR/machines. Use this to generate the 
# string CFX_NODES needed by ansys195 which requires : as the separator.

export CFX_NODES=$(cfxnodes $TMPDIR/machines | sed -e &#39;s/\*/:/g&#39; -e &#39;s/,/:/g&#39;)
echo $CFX_NODES

# Run ansys mechanical - Note: use ansys195 instead of ansys and -p argument
# needed to switch to a valid UCL license.

ansys195 -dis -b -p aa_r -machines $CFX_NODES &lt; steady_state_input_file.dat
</code></pre></div>
</td></tr></table>

<p>If you have access to Grace, this test input and jobscript are available at <code>/home/ccaabaa/Software/ANSYS/steady_state_input_file.dat</code> and <code>/home/ccaabaa/Software/ANSYS/ansys-mech-ex.sh</code></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../Paid-For_Resources/Purchasing_in_Myriad/" title="Purchasing in Myriad" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Purchasing in Myriad
              </span>
            </div>
          </a>
        
        
          <a href="../Matlab/" title="MATLAB" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                MATLAB
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2014 - 2020 UCL Research Computing Group
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/UCL-RITS" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>