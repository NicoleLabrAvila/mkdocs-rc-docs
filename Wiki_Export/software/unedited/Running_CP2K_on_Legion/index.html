



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the centrally provided Research Computing HPC services at UCL.">
      
      
        <link rel="canonical" href="http://rits.github-pages.ucl.ac.uk/mkdocs-rc-docs/Wiki_Export/software/unedited/Running_CP2K_on_Legion/">
      
      
        <meta name="author" content="UCL RCAS Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Running CP2K on Legion</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.750b69bd.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#22426" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://rits.github-pages.ucl.ac.uk/mkdocs-rc-docs/" title="UCL Research Computing Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../../../img/portico.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              UCL Research Computing Documentation
            </span>
            <span class="md-header-nav__topic">
              Running CP2K on Legion
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://rits.github-pages.ucl.ac.uk/mkdocs-rc-docs/" title="UCL Research Computing Documentation" class="md-nav__button md-logo">
      
        <img src="../../../../img/portico.svg" width="48" height="48">
      
    </a>
    UCL Research Computing Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Welcome to MkDocs" class="md-nav__link">
      Welcome to MkDocs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../Contact_Us/" title="Contact and Support" class="md-nav__link">
      Contact and Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../howto/" title="How do I?" class="md-nav__link">
      How do I?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Systems
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Systems
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Systems/Aristotle/" title="Aristotle" class="md-nav__link">
      Aristotle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Systems/Grace/" title="Grace" class="md-nav__link">
      Grace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Systems/Legion/" title="Legion" class="md-nav__link">
      Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Systems/Michael/" title="MMM Michael" class="md-nav__link">
      MMM Michael
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Systems/Myriad/" title="Myriad" class="md-nav__link">
      Myriad
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Systems/Thomas/" title="MMM Thomas" class="md-nav__link">
      MMM Thomas
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Wiki Export
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Wiki Export
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../" title="Research Computing Services" class="md-nav__link">
      Research Computing Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Accessing_RC_Systems/" title="Accessing RC Systems" class="md-nav__link">
      Accessing RC Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Account_Services/" title="Account Services" class="md-nav__link">
      Account Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Acknowledging_RC_Systems/" title="Acknowledging the Use of RC Systems" class="md-nav__link">
      Acknowledging the Use of RC Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Additional_Resource_Requests/" title="Additional Resource Requests" class="md-nav__link">
      Additional Resource Requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Batch_Processing/" title="Batch Processing" class="md-nav__link">
      Batch Processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Building_and_Running_Matlab_Programs/" title="Building and Running Matlab Programs" class="md-nav__link">
      Building and Running Matlab Programs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cluster_Computing/" title="Cluster Computing" class="md-nav__link">
      Cluster Computing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Compiling/" title="Compiling your code" class="md-nav__link">
      Compiling your code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Connecting_to_Research_Data_Services/" title="Connecting to Research Data Services" class="md-nav__link">
      Connecting to Research Data Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Example_Submission_Scripts/" title="Example Submission Scripts" class="md-nav__link">
      Example Submission Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../GPU_Clusters/" title="GPU clusters" class="md-nav__link">
      GPU clusters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../GPU_Nodes/" title="GPU nodes" class="md-nav__link">
      GPU nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Installing_PGI/" title="Installing PGI" class="md-nav__link">
      Installing PGI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Interactive_Jobs/" title="Interactive Job Sessions" class="md-nav__link">
      Interactive Job Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Known_Issues/" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../News_and_Events/" title="News and Events" class="md-nav__link">
      News and Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Paid-For_Resources/" title="Paid-For Resources" class="md-nav__link">
      Paid-For Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Planned_Service_Outages/" title="Planned Service Outages" class="md-nav__link">
      Planned Service Outages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Points_of_Contact/" title="Points of Contact" class="md-nav__link">
      Points of Contact
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Publications/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Quick_Start/" title="Legion Quick Start" class="md-nav__link">
      Legion Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../RC_Systems/" title="Research Computing Platforms" class="md-nav__link">
      Research Computing Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../RC_Systems_user_environment/" title="RC Systems user environment" class="md-nav__link">
      RC Systems user environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Reporting_problems/" title="Reporting problems" class="md-nav__link">
      Reporting problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Research_Computing_Glossary/" title="Research Computing Glossary" class="md-nav__link">
      Research Computing Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Terms_and_Conditions/" title="Terms and Conditions" class="md-nav__link">
      Terms and Conditions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../The_Scheduler/" title="How the scheduler works" class="md-nav__link">
      How the scheduler works
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Training/" title="Training" class="md-nav__link">
      Training
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../UCL_UK_e-Science_Certificates/" title="UCL UK e-Science Certificates" class="md-nav__link">
      UCL UK e-Science Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../User_Scripts/" title="User Scripts" class="md-nav__link">
      User Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../X-Forwarding/" title="X-Forwarding" class="md-nav__link">
      X-Forwarding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../X11_Forwarding_with_Windows/" title="X11 Forwarding With Windows" class="md-nav__link">
      X11 Forwarding With Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-35" type="checkbox" id="nav-5-35">
    
    <label class="md-nav__link" for="nav-5-35">
      Needs work
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-35">
        Needs work
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../needs_work/Managing_Data_on_RC_Systems/" title="Managing Data on RC Systems" class="md-nav__link">
      Managing Data on RC Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../needs_work/Resource_Allocation/" title="Resource Allocation" class="md-nav__link">
      Resource Allocation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../needs_work/Running_Hybrid_OpenMP__MPI_Code/" title="Running Hybrid OpenMP/MPI Code" class="md-nav__link">
      Running Hybrid OpenMP/MPI Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../needs_work/Summary_of_Legion_changes/" title="Summary of Legion changes" class="md-nav__link">
      Summary of Legion changes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-36" type="checkbox" id="nav-5-36" checked>
    
    <label class="md-nav__link" for="nav-5-36">
      Software
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-36">
        Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-36-1" type="checkbox" id="nav-5-36-1">
    
    <label class="md-nav__link" for="nav-5-36-1">
      Done
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-5-36-1">
        Done
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/ANSYS/" title="ANSYS Software" class="md-nav__link">
      ANSYS Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/ATLAS/" title="ATLAS" class="md-nav__link">
      ATLAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/BEAST/" title="BEAST" class="md-nav__link">
      BEAST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/CASTEP/" title="CASTEP" class="md-nav__link">
      CASTEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/FSL/" title="FSL" class="md-nav__link">
      FSL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/FreeSurfer/" title="FreeSurfer" class="md-nav__link">
      FreeSurfer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/MKL/" title="MKL" class="md-nav__link">
      MKL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/OpenBLAS/" title="OpenBLAS" class="md-nav__link">
      OpenBLAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/Quantum_Espresso/" title="Quantum Espresso" class="md-nav__link">
      Quantum Espresso
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../done/R_packages_available_on_Legion/" title="R packages available on Legion" class="md-nav__link">
      R packages available on Legion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-36-2" type="checkbox" id="nav-5-36-2" checked>
    
    <label class="md-nav__link" for="nav-5-36-2">
      Unedited
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-5-36-2">
        Unedited
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Running CP2K on Legion
      </label>
    
    <a href="./" title="Running CP2K on Legion" class="md-nav__link md-nav__link--active">
      Running CP2K on Legion
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#job-script" title="Job script" class="md-nav__link">
    Job script
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_DL_Poly_4_on_Legion/" title="Running DL Poly 4 on Legion" class="md-nav__link">
      Running DL Poly 4 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_DL_Poly_Classic_1.2_on_Legion/" title="Running DL Poly Classic 1.2 on Legion" class="md-nav__link">
      Running DL Poly Classic 1.2 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_DL_Poly_Classic_1.9_on_Legion/" title="Running DL Poly Classic 1.9 on Legion" class="md-nav__link">
      Running DL Poly Classic 1.9 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_DTI-TK_on_Legion/" title="Running DTI-TK on Legion" class="md-nav__link">
      Running DTI-TK on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_GROMACS_on_Legion/" title="Running GROMACS on Legion" class="md-nav__link">
      Running GROMACS on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_GaussView_5_on_Legion/" title="Running GaussView 5 on Legion" class="md-nav__link">
      Running GaussView 5 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_Gaussian_03_on_Legion/" title="Running Gaussian 03 on Legion" class="md-nav__link">
      Running Gaussian 03 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_Gaussian_09_on_Legion/" title="Running Gaussian 09 on Legion" class="md-nav__link">
      Running Gaussian 09 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_LAMMPS_on_Legion/" title="Running LAMMPS on Legion" class="md-nav__link">
      Running LAMMPS on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_ROOT_on_Legion/" title="Running ROOT on Legion" class="md-nav__link">
      Running ROOT on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_R_3.0.1_on_Legion/" title="Running R 3.0.1 on Legion" class="md-nav__link">
      Running R 3.0.1 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_SPM_on_Legion/" title="Running SPM on Legion" class="md-nav__link">
      Running SPM on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_StarCCM%2B_on_Legion/" title="Running StarCCM+ on Legion" class="md-nav__link">
      Running StarCCM+ on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_StarCD_on_Legion/" title="Running StarCD on Legion" class="md-nav__link">
      Running StarCD on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_Stata__MP_on_Legion/" title="Running Stata/MP on Legion" class="md-nav__link">
      Running Stata/MP on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_TopHat_on_Legion/" title="Running TopHat on Legion" class="md-nav__link">
      Running TopHat on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_TractoR_on_Legion/" title="Running TractoR on Legion" class="md-nav__link">
      Running TractoR on Legion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#job-script" title="Job script" class="md-nav__link">
    Job script
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/UCL-RITS/mkdocs-rc-docs/blob/master/mkdocs-project-dir/docs/Wiki_Export/software/unedited/Running_CP2K_on_Legion.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="22426">2.2.426<a class="headerlink" href="#22426" title="Permanent link">&para;</a></h1>
<p>The module for this version is contained in the chemistry modules, so
you will need to load the module set that contains it before it is
visible in the modules list: ```</p>
<p><code>module load chemistry-modules</code></p>
<p><code>CP2K should then be visible as:</code></p>
<p><code>module avail</code></p>
<p><code>[.....]</code></p>
<p><code>----- /shared/ucl/depts/chemistry/modulefiles -----</code><br />
<code>cp2k/2.2.426/openmpi/gnu.4.6.3/cp2k</code></p>
<div class="codehilite"><pre><span></span>### Submitter

An automatic submitter is available for this version, available by
loading the submission scripts module from the chemistry set: ```

`module load chemistry-modules`  
`module load submission-scripts`

``` The alias &quot;submitters&quot; will then list the submitters available.

The &quot;cp2k.submit&quot; submitter takes up to 5 arguments, and any omitted
will be asked for interactively:
</pre></div>


<p><code>cp2k.submit «input_file» «cores» «maximum_run_time» «memory_per_core» «job_name»</code></p>
<p><code>So, for example:</code></p>
<p><code>cp2k.submit water.inp 8 2:00:00 4G mywatermolecule</code></p>
<p>``` would request a job running CP2K with the input file
"water.inp", on 8 cores, with a maximum runtime of 2 hours, with 4
gigabytes of memory per core, and a job name of "mywatermolecule".</p>
<h3 id="job-script">Job script<a class="headerlink" href="#job-script" title="Permanent link">&para;</a></h3>
<p>As with the previous versions, some extra arguments to the OpenMPI
mpirun command are necessary. An example job script is below:</p>
<table>
<tbody>
<tr class="odd">
<td><p>```</p>
<p>```#!/bin/bash -l```<br />
```# setting up the environment for SGE:```<br />
```#$ -S /bin/bash -l```<br />
```#$ -cwd```<br />
```#$ -N CP2K-Job```</p>
<p>```# Set your project name here:```<br />
```#$ -P  Project_Name ```</p>
<p>```# If necessary, alter the maximum quantity of memory here:```<br />
```#$ -l mem=2G```</p>
<p>```# Alter the maximum run time here (hours:minutes:seconds)```<br />
```#$ -l h_rt=10:00:00```</p>
<p>```# Alter the number of processors here:```<br />
```#$ -pe openmpi 1 ```</p>
<p>```# loading the correct modules```<br />
```module add chemistry-modules```<br />
```module add cp2k/2.2.426/openmpi/gnu.4.6.3/cp2k ```</p>
<p>```#Modify this to name your input file```<br />
```InputFile=ACP2KFile.inp```</p>
<p>```OutputFile=${InputFile%\.inp}.log```</p>
<p>```mpirun --mca btl ^tcp -n $NSLOTS cp2k.popt $InputFile &gt; $OutputFile```</p>
<p>```</p></td>
</tr>
</tbody>
</table>

<h1 id="branch-2951-and-trunk">branch 2_1 and trunk<a class="headerlink" href="#branch-2951-and-trunk" title="Permanent link">&para;</a></h1>
<p>To use these versions of CP2K on Legion, you will have to make
considerable changes to your user environment, including using a test
build of OpenMPI specifically designed for this purpose.</p>
<p>You also need to pick which CP2K package you wish to use: trunk, or
branch 2_1 - the jobscript below selects branch 2_1 - if you require
trunk, you will need to change the module specification.</p>
<h3 id="job-script_1">Job script<a class="headerlink" href="#job-script_1" title="Permanent link">&para;</a></h3>
<p>In order to use this special version of OpenMPI, you need to make a few
changes to the normal OpenMPI job script. An example job script is shown
below:</p>
<table>
<tbody>
<tr class="odd">
<td><p>```</p>
<p>```#!/bin/bash -l```</p>
<p>```# 1. Force bash as the executing shell.```<br />
```#$ -S /bin/bash```</p>
<p>```# 2. Request ten minutes of wallclock time (format hours:minutes:seconds).```<br />
```#$ -l h_rt=0:30:0```</p>
<p>```# 3. Request 1 gigabyte of RAM.```<br />
```#$ -l mem=1G```</p>
<p>```# 4. Set the name of the job.```<br />
```#$ -N cp2k-branch-openmpi-gcc440-test-dev```</p>
<p>```# 5. Select the OpenMPI parallel environment and 8 processors.```<br />
```#$ -pe openmpi  8```</p>
<p>```# 6. Select the project that this job will run under.```<br />
```#$ -P ```<your_project_id></p>
<p>```# 7. Set the working directory to somewhere in your scratch space.  This is```<br />
```# a necessary step with the upgraded software stack as compute nodes cannot```<br />
```# write to $HOME.```<br />
```#$ -wd /home/```<your_UCL_id>```/scratch/```</p>
<p>```# 8. Run our MPI job.  ```</p>
<p>```module add compilers/gnu/4.4.0```<br />
```module add mpi/openmpi/1.4.1/gnu.4.4.0```<br />
```module add fftw/2.1.5/double/gnu.4.4.0```<br />
```module add atlas/3.8.3/gnu.4.4.0```<br />
```module add blacs/patch03/gnu.4.4.0```<br />
```module add scalapack/1.8.0/gnu.4.4.0```<br />
```module add cp2k/2_1-branch/openmpi/gnu.4.4.0```</p>
<p>```# Delete OpenMPI PE SSH wrapper```<br />
```rm $TMPDIR/ssh```</p>
<p>```# Need to add in --prefix $MPI_HOME as not using system OpenMPI```<br />
```mpirun --prefix $MPI_HOME -machinefile $TMPDIR/machines -np $NSLOTS `which cp2k.popt` C.inp```</p>
<p>```</p></td>
</tr>
</tbody>
</table>

<p>The main differences between this script and the normal OpenMPI scripts
is that we have to delete an SSH wrapper from $TMPDIR/ssh and insert
--prefix $MPI_HOME into our mpirun command. Note that we've also forced
the loading of the correct modules in the job script. This assumes you
have an input file called C.inp in your working directory. Amend this
script as necessary.</p>
<p>If you put the modules into your job script as above, you should not
need to have them in your .bashrc, but it's probably worth doing so just
to be on the safe side, unless doing so causes clashes with other
programs you want to use.</p>
<p><a href="Category:Bash_script_pages" title="wikilink">Category:Bash script pages</a>
<a href="Category:Legion" title="wikilink">Category:Legion</a> <a href="Category:Legion_Applications" title="wikilink">Category:Legion
Applications</a> <a href="Category:Legion_Software" title="wikilink">Category:Legion
Software</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../done/R_packages_available_on_Legion/" title="R packages available on Legion" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                R packages available on Legion
              </span>
            </div>
          </a>
        
        
          <a href="../Running_DL_Poly_4_on_Legion/" title="Running DL Poly 4 on Legion" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Running DL Poly 4 on Legion
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2014 - 2018 UCL Research Computing Group
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/UCL-RITS" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
    
  </body>
</html>