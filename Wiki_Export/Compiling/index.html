



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the centrally provided Research Computing HPC services at UCL.">
      
      
        <link rel="canonical" href="http://rits.github-pages.ucl.ac.uk/mkdocs-rc-docs/Wiki_Export/Compiling/">
      
      
        <meta name="author" content="UCL RCAS Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Compiling your code</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#compiling-your-code" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://rits.github-pages.ucl.ac.uk/mkdocs-rc-docs/" title="UCL Research Computing Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../img/portico.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              UCL Research Computing Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Compiling your code
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://rits.github-pages.ucl.ac.uk/mkdocs-rc-docs/" title="UCL Research Computing Documentation" class="md-nav__button md-logo">
      
        <img src="../../img/portico.svg" width="48" height="48">
      
    </a>
    UCL Research Computing Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/UCL-RITS/mkdocs-rc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    UCL-RITS/mkdocs-rc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Contact_Us/" title="Contact and Support" class="md-nav__link">
      Contact and Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../New_Users/" title="Guide for New Users" class="md-nav__link">
      Guide for New Users
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Run_Job/" title="How do I run a job?" class="md-nav__link">
      How do I run a job?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../howto/" title="How do I?" class="md-nav__link">
      How do I?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Background/Batch_Processing/" title="Batch Processing" class="md-nav__link">
      Batch Processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Background/Cluster_Computing/" title="Cluster Computing" class="md-nav__link">
      Cluster Computing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Background/The_Scheduler/" title="How the scheduler works" class="md-nav__link">
      How the scheduler works
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Systems
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Systems
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Systems/Aristotle/" title="Aristotle" class="md-nav__link">
      Aristotle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Systems/Grace/" title="Grace" class="md-nav__link">
      Grace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Systems/Legion/" title="Legion" class="md-nav__link">
      Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Systems/Michael/" title="MMM Michael" class="md-nav__link">
      MMM Michael
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Systems/Myriad/" title="Myriad" class="md-nav__link">
      Myriad
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Systems/Thomas/" title="MMM Thomas" class="md-nav__link">
      MMM Thomas
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Wiki Export
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Wiki Export
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Acknowledging_RC_Systems/" title="Acknowledging the Use of RC Systems" class="md-nav__link">
      Acknowledging the Use of RC Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Additional_Resource_Requests/" title="Additional Resource Requests" class="md-nav__link">
      Additional Resource Requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Building_and_Running_Matlab_Programs/" title="Building and Running Matlab Programs" class="md-nav__link">
      Building and Running Matlab Programs
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Compiling your code
      </label>
    
    <a href="./" title="Compiling your code" class="md-nav__link md-nav__link--active">
      Compiling your code
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-your-code" title="Download your code" class="md-nav__link">
    Download your code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-your-modules" title="Set up your modules" class="md-nav__link">
    Set up your modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-compilers" title="Available compilers" class="md-nav__link">
    Available compilers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-systems" title="Build systems" class="md-nav__link">
    Build systems
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automake-configure" title="Automake configure" class="md-nav__link">
    Automake configure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmake" title="CMake" class="md-nav__link">
    CMake
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make" title="Make" class="md-nav__link">
    Make
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avx-instructions" title="AVX instructions" class="md-nav__link">
    AVX instructions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#intel-compilers" title="Intel compilers" class="md-nav__link">
    Intel compilers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gnu-compilers" title="GNU compilers" class="md-nav__link">
    GNU compilers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict-node-type" title="Restrict node type" class="md-nav__link">
    Restrict node type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-for-avx" title="Test for AVX" class="md-nav__link">
    Test for AVX
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blas-and-lapack" title="BLAS and LAPACK" class="md-nav__link">
    BLAS and LAPACK
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-your-path-and-other-environment-variables" title="Set your PATH and other environment variables" class="md-nav__link">
    Set your PATH and other environment variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" title="Python" class="md-nav__link">
    Python
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-compiler-module" title="Set compiler module" class="md-nav__link">
    Set compiler module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-your-own-packages-in-the-same-virtualenv" title="Install your own packages in the same virtualenv" class="md-nav__link">
    Install your own packages in the same virtualenv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-your-own-virtualenvs" title="Use your own virtualenvs" class="md-nav__link">
    Use your own virtualenvs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-via-setuppy" title="Installing via setup.py" class="md-nav__link">
    Installing via setup.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-script-executable-paths" title="Python script executable paths" class="md-nav__link">
    Python script executable paths
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#perl" title="Perl" class="md-nav__link">
    Perl
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpan" title="CPAN" class="md-nav__link">
    CPAN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-perl5lib-paths" title="Set PERL5LIB paths" class="md-nav__link">
    Set PERL5LIB paths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#errors-when-using-non-default-perl-versions" title="Errors when using non-default Perl versions" class="md-nav__link">
    Errors when using non-default Perl versions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#warningspm" title="warnings.pm" class="md-nav__link">
    warnings.pm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libperlso-not-found" title="libperl.so not found" class="md-nav__link">
    libperl.so not found
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r" title="R" class="md-nav__link">
    R
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compiling-with-mpi" title="Compiling with MPI" class="md-nav__link">
    Compiling with MPI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-openmp" title="Enabling OpenMP" class="md-nav__link">
    Enabling OpenMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems" title="Problems" class="md-nav__link">
    Problems
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Connecting_to_RC_Systems/" title="Connecting to RC Systems" class="md-nav__link">
      Connecting to RC Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Connecting_to_Research_Data_Services/" title="Connecting to Research Data Services" class="md-nav__link">
      Connecting to Research Data Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Example_Submission_Scripts/" title="Example Submission Scripts" class="md-nav__link">
      Example Submission Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GPU_Clusters/" title="GPU clusters" class="md-nav__link">
      GPU clusters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GPU_Nodes/" title="GPU nodes" class="md-nav__link">
      GPU nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Getting_an_Account/" title="Getting an Account" class="md-nav__link">
      Getting an Account
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Installing_PGI/" title="Installing PGI" class="md-nav__link">
      Installing PGI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Interactive_Jobs/" title="Interactive Job Sessions" class="md-nav__link">
      Interactive Job Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Known_Issues/" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../News_and_Events/" title="News and Events" class="md-nav__link">
      News and Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Paid-For_Resources/" title="Paid-For Resources" class="md-nav__link">
      Paid-For Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Planned_Service_Outages/" title="Planned Service Outages" class="md-nav__link">
      Planned Service Outages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Points_of_Contact/" title="Points of Contact" class="md-nav__link">
      Points of Contact
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Publications/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Quick_Start/" title="Legion Quick Start" class="md-nav__link">
      Legion Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../RC_Systems/" title="Research Computing Platforms" class="md-nav__link">
      Research Computing Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../RC_Systems_user_environment/" title="RC Systems user environment" class="md-nav__link">
      RC Systems user environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Reporting_problems/" title="Reporting problems" class="md-nav__link">
      Reporting problems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Research_Computing_Glossary/" title="Research Computing Glossary" class="md-nav__link">
      Research Computing Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Terms_and_Conditions/" title="Terms and Conditions" class="md-nav__link">
      Terms and Conditions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Training/" title="Training" class="md-nav__link">
      Training
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../UCL_UK_e-Science_Certificates/" title="UCL UK e-Science Certificates" class="md-nav__link">
      UCL UK e-Science Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../User_Scripts/" title="User Scripts" class="md-nav__link">
      User Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../X-Forwarding/" title="X-Forwarding" class="md-nav__link">
      X-Forwarding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-30" type="checkbox" id="nav-8-30">
    
    <label class="md-nav__link" for="nav-8-30">
      Needs work
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-30">
        Needs work
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../needs_work/Managing_Data_on_RC_Systems/" title="Managing Data on RC Systems" class="md-nav__link">
      Managing Data on RC Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../needs_work/Resource_Allocation/" title="Resource Allocation" class="md-nav__link">
      Resource Allocation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../needs_work/Running_Hybrid_OpenMP__MPI_Code/" title="Running Hybrid OpenMP/MPI Code" class="md-nav__link">
      Running Hybrid OpenMP/MPI Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../needs_work/Summary_of_Legion_changes/" title="Summary of Legion changes" class="md-nav__link">
      Summary of Legion changes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-31" type="checkbox" id="nav-8-31">
    
    <label class="md-nav__link" for="nav-8-31">
      Software
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-31">
        Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-31-1" type="checkbox" id="nav-8-31-1">
    
    <label class="md-nav__link" for="nav-8-31-1">
      Done
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-31-1">
        Done
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/ANSYS/" title="ANSYS Software" class="md-nav__link">
      ANSYS Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/ATLAS/" title="ATLAS" class="md-nav__link">
      ATLAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/BEAST/" title="BEAST" class="md-nav__link">
      BEAST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/CASTEP/" title="CASTEP" class="md-nav__link">
      CASTEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/FSL/" title="FSL" class="md-nav__link">
      FSL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/FreeSurfer/" title="FreeSurfer" class="md-nav__link">
      FreeSurfer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/MKL/" title="MKL" class="md-nav__link">
      MKL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/OpenBLAS/" title="OpenBLAS" class="md-nav__link">
      OpenBLAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/Quantum_Espresso/" title="Quantum Espresso" class="md-nav__link">
      Quantum Espresso
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/done/R_packages_available_on_Legion/" title="R packages available on Legion" class="md-nav__link">
      R packages available on Legion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-31-2" type="checkbox" id="nav-8-31-2">
    
    <label class="md-nav__link" for="nav-8-31-2">
      Unedited
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-31-2">
        Unedited
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_CP2K_on_Legion/" title="Running CP2K on Legion" class="md-nav__link">
      Running CP2K on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_DL_Poly_4_on_Legion/" title="Running DL Poly 4 on Legion" class="md-nav__link">
      Running DL Poly 4 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_GROMACS_on_Legion/" title="Running GROMACS on Legion" class="md-nav__link">
      Running GROMACS on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_Gaussian_09_on_Legion/" title="Running Gaussian 09 on Legion" class="md-nav__link">
      Running Gaussian 09 on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_LAMMPS_on_Legion/" title="Running LAMMPS on Legion" class="md-nav__link">
      Running LAMMPS on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_ROOT_on_Legion/" title="Running ROOT on Legion" class="md-nav__link">
      Running ROOT on Legion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/unedited/Running_TractoR_on_Legion/" title="Running TractoR on Legion" class="md-nav__link">
      Running TractoR on Legion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-your-code" title="Download your code" class="md-nav__link">
    Download your code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-your-modules" title="Set up your modules" class="md-nav__link">
    Set up your modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-compilers" title="Available compilers" class="md-nav__link">
    Available compilers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-systems" title="Build systems" class="md-nav__link">
    Build systems
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automake-configure" title="Automake configure" class="md-nav__link">
    Automake configure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmake" title="CMake" class="md-nav__link">
    CMake
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make" title="Make" class="md-nav__link">
    Make
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avx-instructions" title="AVX instructions" class="md-nav__link">
    AVX instructions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#intel-compilers" title="Intel compilers" class="md-nav__link">
    Intel compilers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gnu-compilers" title="GNU compilers" class="md-nav__link">
    GNU compilers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict-node-type" title="Restrict node type" class="md-nav__link">
    Restrict node type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-for-avx" title="Test for AVX" class="md-nav__link">
    Test for AVX
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blas-and-lapack" title="BLAS and LAPACK" class="md-nav__link">
    BLAS and LAPACK
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-your-path-and-other-environment-variables" title="Set your PATH and other environment variables" class="md-nav__link">
    Set your PATH and other environment variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" title="Python" class="md-nav__link">
    Python
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-compiler-module" title="Set compiler module" class="md-nav__link">
    Set compiler module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-your-own-packages-in-the-same-virtualenv" title="Install your own packages in the same virtualenv" class="md-nav__link">
    Install your own packages in the same virtualenv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-your-own-virtualenvs" title="Use your own virtualenvs" class="md-nav__link">
    Use your own virtualenvs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-via-setuppy" title="Installing via setup.py" class="md-nav__link">
    Installing via setup.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-script-executable-paths" title="Python script executable paths" class="md-nav__link">
    Python script executable paths
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#perl" title="Perl" class="md-nav__link">
    Perl
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpan" title="CPAN" class="md-nav__link">
    CPAN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-perl5lib-paths" title="Set PERL5LIB paths" class="md-nav__link">
    Set PERL5LIB paths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#errors-when-using-non-default-perl-versions" title="Errors when using non-default Perl versions" class="md-nav__link">
    Errors when using non-default Perl versions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#warningspm" title="warnings.pm" class="md-nav__link">
    warnings.pm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libperlso-not-found" title="libperl.so not found" class="md-nav__link">
    libperl.so not found
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r" title="R" class="md-nav__link">
    R
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compiling-with-mpi" title="Compiling with MPI" class="md-nav__link">
    Compiling with MPI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-openmp" title="Enabling OpenMP" class="md-nav__link">
    Enabling OpenMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems" title="Problems" class="md-nav__link">
    Problems
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/UCL-RITS/mkdocs-rc-docs/blob/master/mkdocs-project-dir/docs/Wiki_Export/Compiling.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="compiling-your-code">Compiling Your Code<a class="headerlink" href="#compiling-your-code" title="Permanent link">&para;</a></h1>
<h2 id="download-your-code">Download your code<a class="headerlink" href="#download-your-code" title="Permanent link">&para;</a></h2>
<p>Use wget or curl to download the source code for the software you want
to install to your account. There might be binaries available, but they
often won't work on our clusters because they were compiled for other
machines with other library versions available. Use tar or unzip or
similar depending on archive type to uncompress your source code.</p>
<div class="codehilite"><pre><span></span>wget https://www.example.com/program.tar.gz
tar -xvf program.tar.gz
</pre></div>


<p>You won't be able to use a package manager like yum, you'll need to
follow the manual installation instructions for a user-space install
(not using sudo).</p>
<h2 id="set-up-your-modules">Set up your modules<a class="headerlink" href="#set-up-your-modules" title="Permanent link">&para;</a></h2>
<p>Before you start compiling, you need to make sure you have the right
compilers, libraries and other tools available for your software. If you
haven't changed anything, you will have the default modules loaded. For
more information on how to use modules, see <a href="RC_Systems_user_environment">RC Systems user environment</a>.</p>
<p>Check what the instructions for your software tell you about compiling
it. If the website doesn't say much, the source code will hopefully have
a <code>README</code> or <code>INSTALL</code> file.</p>
<p>You may want to use a different compiler - the default is the Intel
compiler.</p>
<p><code>module avail compilers</code> will show you all the compiler modules
available. Most Open Source software tends to assume you're using GCC
and OpenMPI (if it uses MPI) and is most tested with that combination,
so if it doesn't specify you may want to begin there (do check what the
newest modules available are):</p>
<div class="codehilite"><pre><span></span>module unload compilers mpi mkl
module load compilers/gnu/4.9.2  
module load mpi/openmpi/1.10.1/gnu-4.9.2
</pre></div>


<h2 id="available-compilers">Available compilers<a class="headerlink" href="#available-compilers" title="Permanent link">&para;</a></h2>
<p>The following compilers are available and supported on Legion:</p>
<ul>
<li>Intel C, C++ and Fortran</li>
<li>GNU C, C++ and Fortran</li>
</ul>
<p>We currently have a limited number of licenses for the Intel compilers
so only a certain number of users can use them simultaneously. This
means that your compilation may fail with an error complaining about not
being able to obtain a valid license. If this happens, simply wait for a
few minutes and try again.</p>
<p>In addition to the supported tools, there are a number of tools
installed on Legion which are not supported (for example the PGI
compilers) which were installed to build certain supported packages.
Users who use the unsupported packages do so at their own risk.</p>
<h2 id="build-systems">Build systems<a class="headerlink" href="#build-systems" title="Permanent link">&para;</a></h2>
<p>Most software will use some kind of build system to manage how files are
compiled and linked and in what order. Here are a few common ones.</p>
<h3 id="automake-configure">Automake configure<a class="headerlink" href="#automake-configure" title="Permanent link">&para;</a></h3>
<p><a href="http://www.gnu.org/software/automake/manual/automake.html">Automake</a>
will generate the Makefile for you and hopefully pick up sensible
options through configuration. You can give it an install prefix to tell
it where to install (or you can build it in place and not use make
install at all).</p>
<div class="codehilite"><pre><span></span>./configure --prefix=/home/username/place/you/want/to/install  
make  
# if it has a test suite, good idea to use it  
make test   
make install
</pre></div>


<p>If it has more configuration flags, you can use <code>./configure --help</code> to
view them.</p>
<p>Usually configure will create a config.log: you can look in there to
find if any tests have failed or things you think should have been
picked up haven't.</p>
<h3 id="cmake">CMake<a class="headerlink" href="#cmake" title="Permanent link">&para;</a></h3>
<p><a href="http://www.cmake.org/">CMake</a> is another build system. It will have a
CMakeFile or the instructions will ask you to use cmake or ccmake rather
than make. It also generates Makefiles for you. <code>ccmake</code> is a
terminal-based interactive interface where you can see what variables
are set to and change them, then repeatedly configure until everything
is correct, generate the Makefile and quit. <code>cmake</code> is the commandline
version. The process tends to go like
this:</p>
<div class="codehilite"><pre><span></span>ccmake CMakeLists.txt  
# press c to configure - will pick up some options  
# press t to toggle advanced options  
# keep making changes and configuring until no more errors or changes  
# press g to generate and exit  
make  
# if it has a test suite, good idea to use it  
make test   
make install
</pre></div>


<p>If you need to rerun ccmake and reconfigure, remember to delete the
<code>CMakeCache.txt</code> file, or you'll be wondering why your changes haven't taken.
Turning on verbose Makefiles in ccmake is also useful if your code
didn't compile first time - you'll be able to see what flags the
compiler or linker is actually being given when it fails.</p>
<h3 id="make">Make<a class="headerlink" href="#make" title="Permanent link">&para;</a></h3>
<p>Your code may just come with a Makefile and have no configure, in which
case the generic way to compile it is as follows:</p>
<div class="codehilite"><pre><span></span>make targetname
</pre></div>


<p>There's usually a default target, which <code>make</code> on its own will use. If
you need to change any configuration options, you'll need to edit those
sections of the Makefile (at the top, where the variables/flags are
defined).</p>
<p>Here are some typical variables you may want to change in a Makefile.</p>
<p>These are what compilers/mpi wrappers to use - these are also defined by
the compiler modules, so you can see what they should be. Intel would be
icc, icpc, ifort, for example. If it's a program that can be compiled
using MPI and only has a variable for CC, then set that to mpicc.</p>
<div class="codehilite"><pre><span></span>CC=gcc  
CXX=g++  
FC=gfortran  
MPICC=mpicc  
MPICXX=mpicxx  
MPIF90=mpif90
</pre></div>


<p>CFLAGS and LDFLAGS are flags for the compiler and linker respectively,
and there might be LIBS or INCLUDE as well. When linking a library with
the name libfoo, use <code>-lfoo</code>.</p>
<div class="codehilite"><pre><span></span>CFLAGS=&quot;-I/path/to/include&quot;  
LDFLAGS=&quot;-L/path/to/foo/lib -L/path/to/bar/lib&quot;  
LDLIBS=&quot;-lfoo -lbar&quot;
</pre></div>


<p>Remember to <code>make clean</code> first if you are recompiling with new options!</p>
<h2 id="avx-instructions">AVX instructions<a class="headerlink" href="#avx-instructions" title="Permanent link">&para;</a></h2>
<p><strong>Note</strong>: Legion's current login nodes are of a newer architecture than
some of the compute nodes - the login nodes have AVX instructions but
the XYZ type nodes do not. This means if you want your code to run on
the older nodes, some compiler options cannot be used (e.g.
<code>-march=native</code>, <code>-mtune</code>, <code>-xHost</code>) or your code will segfault.</p>
<p>You can either build the code on the login nodes and restrict your jobs
to only running on the newer nodes, compile the code with appropriate
options for all the nodes, or compile your code inside a job that is
running on the XYZ nodes (or during a qrsh session on the same).</p>
<h3 id="intel-compilers">Intel compilers<a class="headerlink" href="#intel-compilers" title="Permanent link">&para;</a></h3>
<p>To tell the Intel compilers to build for SSE4.2 instructions and no AVX,
add this to CFLAGS (and CXXFLAGS if relevant):</p>
<div class="codehilite"><pre><span></span>CFLAGS=-axSSE4.2
</pre></div>


<p>(Also see <code>icc -help codegen</code>).</p>
<h3 id="gnu-compilers">GNU compilers<a class="headerlink" href="#gnu-compilers" title="Permanent link">&para;</a></h3>
<p>To tell GCC to build for SSE4.2 without AVX, add this to CFLAGS (and
CXXFLAGS if relevant): </p>
<div class="codehilite"><pre><span></span>CFLAGS=-march=nehalem
</pre></div>


<h3 id="restrict-node-type">Restrict node type<a class="headerlink" href="#restrict-node-type" title="Permanent link">&para;</a></h3>
<p>To restrict a job to newer nodes only, put this in your script:</p>
<div class="codehilite"><pre><span></span>#$ -ac allow=LMNOPQSTU
</pre></div>


<p>You can also compile one version without AVX and one with, so you can
take advantage of the newer nodes when possible. You could use
<code>hostname</code> in your jobscript to check what type of node you were on and
run the appropriate binary. Hostnames begin with node-x for an X-type
node, node-u for a U-type and so on.</p>
<h3 id="test-for-avx">Test for AVX<a class="headerlink" href="#test-for-avx" title="Permanent link">&para;</a></h3>
<p>We have a script that will let you test whether your compiled code is
using AVX instructions. If you pass it a directory it will recursively
test everything in there. Note that if your code builds multiple kernels
and so can choose based on where it runs which instructions to use (like
MKL) then this will find AVX instructions but they won't cause your code
to segfault.</p>
<div class="codehilite"><pre><span></span>find /home/username/path/ -perm /111 -type f | xargs /shared/ucl/apps/rcops_scripts/hasavx -q
</pre></div>


<h2 id="blas-and-lapack">BLAS and LAPACK<a class="headerlink" href="#blas-and-lapack" title="Permanent link">&para;</a></h2>
<p>BLAS and LAPACK are provided as part of MKL, OpenBLAS or ATLAS. There
are several different OpenBLAS and ATLAS modules on Legion for different
compilers. MKL is available in the Intel compiler module.</p>
<p>Your code may try to link <code>-lblas -llapack</code>: this isn't the right way to
use BLAS and LAPACK with MKL or ATLAS (our OpenBLAS now has symlinks
that allow you to do this).</p>
<ul>
<li><a href="MKL_on_Legion" title="wikilink">MKL on Legion</a></li>
<li><a href="OpenBLAS_on_Legion" title="wikilink">OpenBLAS on Legion</a></li>
<li><a href="ATLAS_on_Legion" title="wikilink">ATLAS on Legion</a></li>
</ul>
<h2 id="set-your-path-and-other-environment-variables">Set your PATH and other environment variables<a class="headerlink" href="#set-your-path-and-other-environment-variables" title="Permanent link">&para;</a></h2>
<p>After you have installed your software, you'll need to add it to your
<code>PATH</code> environment variable so you can run it without having to give the
full path to its location.</p>
<p>Put this in your <code>~/.bashrc</code> file so it will set this with every new session you
create. Replace username with your username and point to the directory
your binary was built in (frequently <code>program/bin</code>). This adds it to the
front of your PATH, so if you install a newer version of something, it
will be found before the system one.</p>
<div class="codehilite"><pre><span></span>export PATH=/home/username/location/of/software/binary:$PATH
</pre></div>


<p>If you built a library that you'll go on to compile other software with,
you probably want to also add the lib directory to your
LD_LIBRARY_PATH and LIBRARY_PATH, and the include directory to CPATH
(add export statements as above). This may mean your configure step will
pick your library up correctly without any further effort on your part.</p>
<p>To make these changes to your .bashrc take effect in your current
session:</p>
<div class="codehilite"><pre><span></span>source ~/.bashrc
</pre></div>


<h2 id="python">Python<a class="headerlink" href="#python" title="Permanent link">&para;</a></h2>
<p>There are <code>python2/recommended</code> and <code>python3/recommended</code> bundles. These
use a virtualenv and have pip set up for you. They both have numpy and
scipy available.</p>
<h3 id="set-compiler-module">Set compiler module<a class="headerlink" href="#set-compiler-module" title="Permanent link">&para;</a></h3>
<p>The Python versions on Legion were built with GCC. You can run them with
the default Intel compilers loaded because everything depends on the
gcc-libs/4.9.2 module. When you are building your own Python packages
you should have the GCC compiler module loaded however, to avoid the
situation where you build a package with the Intel compiler and then try
to run it with GCC, in which case it will be unable to find
Intel-specific instructions.</p>
<div class="codehilite"><pre><span></span>module unload compilers
module load compilers/gnu/4.9.2
</pre></div>


<p>If you get an error like this when trying to run something, recheck what
compiler you used.</p>
<div class="codehilite"><pre><span></span>undefined symbol: __intel_sse2_strrchr
</pre></div>


<h3 id="install-your-own-packages-in-the-same-virtualenv">Install your own packages in the same virtualenv<a class="headerlink" href="#install-your-own-packages-in-the-same-virtualenv" title="Permanent link">&para;</a></h3>
<p>This will use our central virtualenv, which contains a number of
packages already installed.</p>
<div class="codehilite"><pre><span></span>pip install --user &lt;python2pkg&gt;  
pip3 install --user &lt;python3pkg&gt;
</pre></div>


<p>These will install into <code>.python2local</code> or <code>.python3local</code> directories in your home directory, respectively.</p>
<p>To see what is already installed, the <a href="https://github.com/UCL-RITS/rcps-buildscripts/blob/master/lists/python-shared.list">Python-shared list</a>
shows what is installed for both Python2 and 3, while the <a href="https://github.com/UCL-RITS/rcps-buildscripts/blob/master/lists/python-2.list">Python2 list</a>
and <a href="https://github.com/UCL-RITS/rcps-buildscripts/blob/master/lists/python-3.list">Python3 list</a>
show what is only installed for one or the other. (There may also be
prereqs that aren't listed explicitly - pip will tell you if something
is already installed as long as you have the recommended module bundle
loaded).</p>
<h3 id="use-your-own-virtualenvs">Use your own virtualenvs<a class="headerlink" href="#use-your-own-virtualenvs" title="Permanent link">&para;</a></h3>
<p>If you need different packages that are not compatible with the central
installs, you can create a new virtualenv and only yours will be
available.</p>
<div class="codehilite"><pre><span></span>virtualenv &lt;DIR&gt; 
source &lt;DIR&gt;/bin/activate
</pre></div>


<p>Your bash prompt will show you that a different virtualenv is active.</p>
<h3 id="installing-via-setuppy">Installing via setup.py<a class="headerlink" href="#installing-via-setuppy" title="Permanent link">&para;</a></h3>
<p>If you need to install using setup.py, you can use the <code>--user</code> flag and
as long as one of the python bundles is loaded, it will install into the
same <code>.python2local</code> or <code>.python3local</code> as pip and you won't need to add
any new paths to your environment.</p>
<div class="codehilite"><pre><span></span>python setup.py install --user
</pre></div>


<p>You can alternatively use <code>--prefix</code> in which case you will have to set
the install prefix to somewhere in your space, and also set PYTHONPATH
and PATH to include your install location. Some installs won't create
the prefix directory for you, in which case create it first. This is
useful if you want to keep this package entirely separate and only in
your paths on demand.</p>
<div class="codehilite"><pre><span></span>export PYTHONPATH=/home/username/your/path/lib/python2.7/site-packages:$PYTHONPATH  
# if necessary, create install path  
mkdir -p home/username/your/path/lib/python2.7/site-packages  
python setup.py install --prefix=/home/username/your/path

# add these to your .bashrc or jobscript  
export PYTHONPATH=/home/username/your/path/lib/python2.7/site-packages:$PYTHONPATH  
export PATH=/home/username/your/path/bin:$PATH
</pre></div>


<p>Check that the PATH is where your Python executables were installed, and
the PYTHONPATH is correct. It will tend to tell you at install time if
you need to change or create the PYTHONPATH directory.</p>
<h3 id="python-script-executable-paths">Python script executable paths<a class="headerlink" href="#python-script-executable-paths" title="Permanent link">&para;</a></h3>
<p>If you have an executable python script giving the location of python
like this, and it fails because that python doesn't exist in that
location or isn't the one that has the additional packages installed:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>#!/usr/bin/python2.6
</pre></div>
</td></tr></table>

<p>You should change it so it uses the first python found in your
environment. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>#!/usr/bin/env python 
</pre></div>
</td></tr></table>

<h2 id="perl">Perl<a class="headerlink" href="#perl" title="Permanent link">&para;</a></h2>
<p>Perl modules will freqently have a Makefile.PL (especially if you
download the tar files from CPAN.org yourself). You can install manually
as:</p>
<div class="codehilite"><pre><span></span>perl Makefile.PL PREFIX=/home/username/your/perl/location
make
make install
</pre></div>


<h3 id="cpan">CPAN<a class="headerlink" href="#cpan" title="Permanent link">&para;</a></h3>
<p>You can use CPAN to download and install modules locally for you. The
first time you run the <code>cpan</code> command, it will create a <code>.cpan</code>
directory for you and ask you to give it configuration settings or allow
it to set them automatically.</p>
<p>You need to tell it where you want your install prefix to be.</p>
<p>If it is automatically configured, you need to edit these lines in your
<code>.cpan/CPAN/MyConfig.pm</code>, for example if you want it to be in a lib
directory in your home (change username to your own username):</p>
<div class="codehilite"><pre><span></span><span class="s">&#39;make_install_arg&#39;</span> <span class="o">=&gt;</span> <span class="sx">q[PREFIX=/home/username/lib]</span><span class="p">,</span>
 <span class="c1"># other lines in here  </span>
<span class="s">&#39;makepl_arg&#39;</span> <span class="o">=&gt;</span> <span class="sx">q[PREFIX=/home/username/lib]</span><span class="p">,</span>
<span class="s">&#39;mbuild_install_arg&#39;</span> <span class="o">=&gt;</span> <span class="sx">q[PREFIX=/home/username/lib]</span><span class="p">,</span>
<span class="s">&#39;mbuildpl_arg&#39;</span> <span class="o">=&gt;</span> <span class="sx">q[--install_base /home/username/lib]</span><span class="p">,</span>
</pre></div>


<p>It will download and build modules inside .cpan and install them where
you specified.</p>
<h3 id="set-perl5lib-paths">Set PERL5LIB paths<a class="headerlink" href="#set-perl5lib-paths" title="Permanent link">&para;</a></h3>
<p>If you install your own Perl or Perl modules, you will need to append
them to your PERL5LIB:</p>
<div class="codehilite"><pre><span></span>export PERL5LIB=/home/username/your/perl/location:$PERL5LIB
</pre></div>


<p>If you installed with CPAN, you may need to add several paths to this
based on the layout it creates inside your nominated Perl directory.</p>
<h3 id="errors-when-using-non-default-perl-versions">Errors when using non-default Perl versions<a class="headerlink" href="#errors-when-using-non-default-perl-versions" title="Permanent link">&para;</a></h3>
<h4 id="warningspm">warnings.pm<a class="headerlink" href="#warningspm" title="Permanent link">&para;</a></h4>
<p>If you are using a version of Perl that is not the default system Perl
and get strange errors when trying to run a Perl script, particularly
ones about
warnings.pm:</p>
<div class="codehilite"><pre><span></span>Search pattern not terminated at /shared/ucl/apps/perl/5.20.0/lib/5.20.0/warnings.pm line 1099
</pre></div>


<p>then you need to edit the script so that instead of beginning with
<code>#!/usr/bin/perl</code>, it begins with <code>#!/usr/bin/env perl</code>. Otherwise it
will try to use the old system Perl libraries with your newer Perl
executable, which won't work.</p>
<h4 id="libperlso-not-found">libperl.so not found<a class="headerlink" href="#libperlso-not-found" title="Permanent link">&para;</a></h4>
<p>You probably built perl without telling it to build the shared library
too. Add <code>-Duseshrplib</code> to your build flags.</p>
<h2 id="r">R<a class="headerlink" href="#r" title="Permanent link">&para;</a></h2>
<p>There are instructions on installing and using local R packages in
<a href="https://wiki.rc.ucl.ac.uk/wiki/R_on_Legion#Using_your_own_local_R_packages">Using your own local R packages</a>.</p>
<h2 id="compiling-with-mpi">Compiling with MPI<a class="headerlink" href="#compiling-with-mpi" title="Permanent link">&para;</a></h2>
<p>OpenMPI and Intel MPI are available. Certain programs do not work well
with one or the other, so if you are having problems try the other one.
Intel MPI is based on MPICH, so if the program you are compiling
mentions that, try Intel MPI first.</p>
<p>The Intel MPI is threadsafe; some versions of OpenMPI aren't.</p>
<p>Note that OpenMPI 1.8.4 had a segv bug in non-blocking collectives that
is fixed in OpenMPI 1.10.1.</p>
<h2 id="enabling-openmp">Enabling OpenMP<a class="headerlink" href="#enabling-openmp" title="Permanent link">&para;</a></h2>
<p>To enable OpenMP with the Intel compilers, you simply need to add
<code>-openmp</code> to your compile line. With the GNU compilers you need to add
<code>-fopenmp</code>.</p>
<h2 id="problems">Problems<a class="headerlink" href="#problems" title="Permanent link">&para;</a></h2>
<p>If you experience problems building your applications, please contact
your local IT support in the first instance. We are available at
rc-support AT ucl.ac.uk to help you if you still cannot build your app
or if you need to report a problem with our software stack.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Building_and_Running_Matlab_Programs/" title="Building and Running Matlab Programs" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Building and Running Matlab Programs
              </span>
            </div>
          </a>
        
        
          <a href="../Connecting_to_RC_Systems/" title="Connecting to RC Systems" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Connecting to RC Systems
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2014 - 2018 UCL Research Computing Group
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/UCL-RITS" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>